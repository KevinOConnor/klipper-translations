# Примерни конфигурации

Този документ съдържа указания за добавяне на примерна конфигурация на Klipper към хранилището на Klipper в github (намира се в директорията [config](../config/)).

Имайте предвид, че сървърът [Klipper Community Discourse server](https://community.klipper3d.org) също е полезен ресурс за намиране и споделяне на конфигурационни файлове.

## Насоки

1. Изберете подходящия префикс на името на файла с конфигурацията:
   1. Префиксът `printer` се използва за серийни принтери, продавани от основен производител.
   1. Префиксът `generic` се използва за платка за 3D принтер, която може да се използва в много различни видове принтери.
   1. Префиксът `комплект` е за 3D принтери, които са сглобени в съответствие с широко използвана спецификация. Тези "комплектни" принтери обикновено се различават от обикновените "принтери" по това, че не се продават от производител.
   1. Префиксът `sample` се използва за "фрагменти" от конфигурацията, които могат да се копират и поставят в основния конфигурационен файл.
   1. Префиксът `example` се използва за описание на кинематиката на принтера. Този тип конфигурация обикновено се добавя само заедно с кода за нов тип кинематика на принтера.
1. Всички конфигурационни файлове трябва да завършват със суфикс `.cfg`. Файловете за конфигуриране на `принтер` трябва да завършват с година, последвана от `.cfg` (например, `-2019.cfg`). В този случай годината е приблизителната година, в която е продаден даденият принтер.
1. Не използвайте интервали или специални символи в името на конфигурационния файл. Името на файла трябва да съдържа само символите `A-Z`, `a-z`, `0-9`, `-` и `.`.
1. Klipper трябва да може да стартира `printer`, `generic` и `kit` примерния конфигурационен файл без грешка. Тези конфигурационни файлове трябва да бъдат добавени към тестовия случай за регресия [test/klippy/printers.test](../test/klippy/printers.test). Добавете нови конфигурационни файлове към този тестови случай в съответния раздел и по азбучен ред в рамките на този раздел.
1. Примерната конфигурация трябва да бъде за конфигурацията "склад" на принтера. (Има твърде много "персонализирани" конфигурации, които могат да бъдат проследени в основното хранилище на Klipper.) По същия начин добавяме примерни конфигурационни файлове само за принтери, комплекти и платки, които са популярни (например, трябва да има поне 100 от тях в активна употреба). Помислете за използването на сървъра [Klipper Community Discourse server](https://community.klipper3d.org) за други конфигурации.
1. Only specify those devices present on the given printer or board. Do not specify settings specific to your particular setup.
   1. For `generic` config files, only those devices on the mainboard should be described. For example, it would not make sense to add a display config section to a "generic" config as there is no way to know if the board will be attached to that type of display. If the board has a specific hardware port to facilitate an optional peripheral (eg, a bltouch port) then one can add a "commented out" config section for the given device.
   1. Не посочвайте `pressure_advance` в примерната конфигурация, тъй като тази стойност е специфична за нишката, а не за хардуера на принтера. По същия начин не посочвайте настройките `max_extrude_only_velocity` (максимална скорост само на екструдиране) и `max_extrude_only_accel` (максимална скорост само на екструдиране).
   1. Не посочвайте раздел от конфигурацията, съдържащ път до хост или хардуер на хост. Например, не посочвайте секциите за конфигуриране `[virtual_sdcard]` и `[temperature_host]`.
   1. Дефинирайте само макроси, които използват функционалност, специфична за дадения принтер, или за дефиниране на g-кодове, които обикновено се излъчват от нарязващите устройства, конфигурирани за дадения принтер.
1. Where possible, it is best to use the same wording, phrasing, indentation, and section ordering as the existing config files.
   1. The top of each config file should list the type of micro-controller the user should select during "make menuconfig". It should also have a reference to "docs/Config_Reference.md".
   1. Не копирайте документацията за полетата в примерните конфигурационни файлове. (Това създава затруднения при поддръжката, тъй като при актуализация на документацията ще се наложи тя да бъде променена на много места.)
   1. Файловете с примерна конфигурация не трябва да съдържат секция "SAVE_CONFIG". Ако е необходимо, копирайте съответните полета от раздела "SAVE_CONFIG" в съответния раздел в основната област на конфигурацията.
   1. Използвайте синтаксиса `field: value` вместо `field=value`.
   1. Когато добавяте `разстояние на въртене` на екструдера, за предпочитане е да посочите `редукторно съотношение`, ако екструдерът има зъбен механизъм. Очакваме разстоянието на въртене в примерните конфигурации да съответства на обиколката на зъбното колело в екструдера - обикновено то е в диапазона от 20 до 35 mm. Когато посочвате съотношение на предавките, за предпочитане е да посочите действителните предавки на механизма (например, предпочитайте `съотношение на предавките: 80:20` пред `съотношение на предавките: 4:1`). За повече информация вижте документа [Разстояние на въртене](Rotation_Distance.md#using-a-gear_ratio).
   1. Избягвайте да определяте стойности на полета, които са зададени като стойност по подразбиране. Например не трябва да се задава `min_extrude_temp: 170`, тъй като това вече е стойността по подразбиране.
   1. По възможност редовете не трябва да надвишават 80 колони.
   1. Избягвайте да добавяте съобщения за атрибуция или ревизия към файловете за конфигуриране. (Например избягвайте да добавяте редове като "този файл е създаден от ...") Поставете атрибуцията и историята на промените в съобщението git commit.
1. Не използвайте никакви остарели функции в примерния конфигурационен файл.
1. Не деактивирайте системата за безопасност по подразбиране в примерния конфигурационен файл. Например в конфигурацията не трябва да се задава потребителски параметър `max_extrude_cross_section`. Не разрешавайте функциите за отстраняване на грешки. Например не трябва да има конфигурационен раздел `force_move`.
1. Всички известни платки, които Klipper поддържа, могат да използват серийната скорост по подразбиране от 250000 бода. Не препоръчвайте различна скорост на предаване на данни в примерния конфигурационен файл.

Файловете с примерни конфигурации се подават чрез създаване на заявка за изтегляне в github. Моля, следвайте и указанията в документа [contributing document](CONTRIBUTING.md).
