# Ръчно нивелиране

Този документ описва инструменти за калибриране на Z-краен ограничител и за извършване на настройки на винтовете за нивелиране на леглото.

## Калибриране на краен ограничител Z

Точната позиция на крайния ограничител Z е от решаващо значение за получаването на висококачествени разпечатки.

Имайте предвид обаче, че точността на самия превключвател на Z-крайника може да бъде ограничаващ фактор. Ако използвате драйвери за стъпкови двигатели Trinamic, помислете дали да не включите откриването на [endstop phase](Endstop_Phase.md), за да подобрите точността на превключвателя.

За да извършите калибриране на крайната точка Z, включете принтера в изходно положение, заповядайте на главата да се премести в позиция Z, която е поне пет милиметра над леглото (ако вече не е), заповядайте на главата да се премести в позиция XY близо до центъра на леглото, след което преминете към раздела на терминала OctoPrint и стартирайте:

```
Z_ENDSTOP_CALIBRATE
```

След това следвайте стъпките, описани в ["the paper test"](Bed_Level.md#the-paper-test), за да определите действителното разстояние между дюзата и леглото на даденото място. След като тези стъпки бъдат завършени, можете да `АКТУАЛИЗИРАТЕ` позицията и да запишете резултатите в конфигурационния файл с:

```
SAVE_CONFIG
```

За предпочитане е да се използва превключвател за спиране на Z в противоположния край на оста Z от леглото. (Отдалечаването от леглото е по-сигурно, тъй като тогава обикновено винаги е безопасно да се постави Z.) Ако обаче трябва да се насочи към леглото, се препоръчва крайният ограничител да се регулира така, че да се задейства на малко разстояние (например 0,5 mm) над леглото. Почти всички крайни ограничители могат безопасно да бъдат натиснати на малко разстояние извън точката на задействане. Когато това се направи, командата `Z_ENDSTOP_CALIBRATE` трябва да отчете малка положителна стойност (напр. .5 mm) за Z позиция_endstop. Задействането на крайния ограничител, докато той все още е на известно разстояние от леглото, намалява риска от непреднамерено падане на леглото.

Някои принтери имат възможност за ръчно регулиране на местоположението на физическия ограничител. Въпреки това се препоръчва Z-позиционирането на крайния ограничител да се извършва софтуерно с Klipper - след като физическото местоположение на крайния ограничител е на удобно място, могат да се правят допълнителни корекции чрез стартиране на Z_ENDSTOP_CALIBRATE или чрез ръчно актуализиране на Z position_endstop в конфигурационния файл.

## Регулиране на винтовете за изравняване на леглото

Тайната на доброто нивелиране на леглото с помощта на винтове за нивелиране на леглото е да се използва високопрецизната система за движение на принтера по време на самия процес на нивелиране на леглото. Това се прави, като дюзата се командва в позиция близо до всеки винт на леглото и след това се регулира този винт, докато леглото се намира на определено разстояние от дюзата. Klipper разполага с инструмент, който помага за това. За да се използва инструментът, е необходимо да се посочи местоположението на всеки винт XY.

Това става чрез създаване на раздел от конфигурацията `[bed_screws]`. Например, тя може да изглежда по следния начин:

```
[bed_screws]
screw1: 100, 50
screw2: 100, 150
screw3: 150, 100
```

Ако винтът на леглото се намира под леглото, посочете позицията XY точно над винта. Ако винтът е извън леглото, посочете най-близката до него позиция XY, която все още е в обхвата на леглото.

След като файлът с конфигурацията е готов, изпълнете `RESTART`, за да заредите тази конфигурация, и след това можете да стартирате инструмента, като изпълните:

```
BED_SCREWS_ADJUST
```

Този инструмент ще премести дюзата на принтера до всяко място на винта XY и след това ще премести дюзата на височина Z=0. В този момент можете да използвате "теста с хартия", за да регулирате винта на леглото директно под дюзата. Вижте информацията, описана в ["the paper test"](Bed_Level.md#the-paper-test), но регулирайте винта на леглото, вместо да командвате дюзата на различни височини. Регулирайте винта на леглото, докато има малко триене при избутване на хартията напред и назад.

След като винтът се регулира така, че да се усеща малко триене, изпълнете командата `ACCEPT` или `ADJUSTED`. Използвайте командата `ADJUSTED`, ако винтът на леглото е трябвало да се регулира (обикновено нещо повече от около 1/8 оборот на винта). Използвайте командата `ACCEPT`, ако не е необходима значителна настройка. И двете команди ще накарат инструмента да премине към следващия винт. (Когато се използва командата `ADJUSTED`, инструментът ще планира допълнителен цикъл на регулиране на винта на леглото; инструментът завършва успешно, когато се провери, че всички винтове на леглото не се нуждаят от значителни настройки.) Може да се използва командата `ABORT` за ранно прекратяване на инструмента.

Тази система работи най-добре, когато принтерът е с плоска печатна повърхност (например стъкло) и има прави релси. След успешното завършване на работата с инструмента за изравняване на леглото леглото трябва да е готово за печат.

### Фини настройки на винта на леглото

Ако принтерът използва три винта за леглото и и трите винта са под леглото, може да е възможно да се извърши втора стъпка за "високопрецизно" изравняване на леглото. Това се извършва чрез подаване на команда към дюзата на места, където леглото се премества на по-голямо разстояние при всяко регулиране на винта на леглото.

Например, разгледайте легло с винтове на местата A, B и C:

![bed_screws](img/bed_screws.svg.png)

При всяко регулиране на винта на леглото в точка С леглото се люлее по махалото, определено от останалите два винта на леглото (показани тук със зелена линия). При това положение всяка настройка на винта на леглото в положение C ще премести леглото в положение D с по-голямо количество, отколкото директно в положение C. По този начин е възможно да се направи подобрена настройка на винта C, когато дюзата е в положение D.

За да активирате тази функция, трябва да определите координатите на допълнителните дюзи и да ги добавите в конфигурационния файл. Например, той може да изглежда така:

```
[bed_screws]
screw1: 100, 50
screw1_fine_adjust: 0, 0
screw2: 100, 150
screw2_fine_adjust: 300, 300
screw3: 150, 100
screw3_fine_adjust: 0, 100
```

Когато тази функция е активирана, инструментът `BED_SCREWS_ADJUST` първо ще поиска груби настройки непосредствено над всяка позиция на винта и след като те бъдат приети, ще поиска фини настройки на допълнителните места. Продължавайте да използвате `ACCEPT` и `ADJUSTED` на всяка позиция.

## Регулиране на винтовете за нивелиране на леглото с помощта на сондата на леглото

Това е друг начин за калибриране на нивото на леглото с помощта на сондата на леглото. За да го използвате, трябва да имате Z-сонда (BL Touch, индуктивен сензор и др.).

За да активирате тази функция, трябва да определите координатите на дюзата така, че Z-сондата да е над винтовете, и след това да ги добавите в конфигурационния файл. Например, той може да изглежда така:

```
[screws_tilt_adjust]
screw1: -5, 30
screw1_name: front left screw
screw2: 155, 30
screw2_name: front right screw
screw3: 155, 190
screw3_name: rear right screw
screw4: -5, 190
screw4_name: rear left screw
horizontal_move_z: 10.
speed: 50.
screw_thread: CW-M3
```

Винт1 винаги е референтна точка за останалите, така че системата приема, че винт1 е на правилната височина. Винаги първо стартирайте `G28` и след това стартирайте `SCREWS_TILT_CALCULATE` - трябва да се получи резултат, подобен на:

```
Send: G28
Recv: ok
Send: SCREWS_TILT_CALCULATE
Recv: // 01:20 means 1 full turn and 20 minutes, CW=clockwise, CCW=counter-clockwise
Recv: // front left screw (base) : x=-5.0, y=30.0, z=2.48750
Recv: // front right screw : x=155.0, y=30.0, z=2.36000 : adjust CW 01:15
Recv: // rear right screw : y=155.0, y=190.0, z=2.71500 : adjust CCW 00:50
Recv: // read left screw : x=-5.0, y=190.0, z=2.47250 : adjust CW 00:02
Recv: ok
```

Това означава, че:

- предният ляв винт е референтната точка, която не трябва да променяте.
- предният десен винт трябва да се завърти по посока на часовниковата стрелка с 1 пълен оборот и една четвърт оборот
- задният десен винт трябва да се завърти обратно на часовниковата стрелка 50 минути
- задният ляв винт трябва да се завърти по посока на часовниковата стрелка за 2 минути (не е необходимо, всичко е наред)

Обърнете внимание, че "минути" се отнася за "минути от циферблата на часовника". Така например 15 минути са една четвърт от цял оборот.

Повторете процеса няколко пъти, докато постигнете добро ниво на леглото - обикновено когато всички настройки са под 6 минути.

Ако използвате сонда, която е монтирана отстрани на нагревателя (т.е. има изместване по X или Y), имайте предвид, че регулирането на наклона на леглото ще анулира всяко предишно калибриране на сондата, което е било извършено при наклонено легло. Не забравяйте да стартирате [калибриране на сонда](Probe_Calibrate.md), след като винтовете на леглото са били регулирани.

Параметърът `MAX_DEVIATION` е полезен, когато се използва запазена мрежа на леглото, за да се гарантира, че нивото на леглото не се е отклонило твърде много от това, което е било при създаването на мрежата. Например параметърът `SCREWS_TILT_CALCULATE MAX_DEVIATION=0,01` може да бъде добавен към потребителския стартов gcode на слайсера, преди да бъде заредена мрежата. Той ще прекъсне печатането, ако конфигурираната граница бъде надхвърлена (0,01 mm в този пример), като даде възможност на потребителя да регулира винтовете и да рестартира печатането.

Параметърът `ДИРЕКЦИЯ` е полезен, ако можете да въртите винтовете за регулиране на леглото само в една посока. Например, може да имате винтове, които започват да се затягат в най-ниското (или най-високото) възможно положение, които могат да се въртят само в една посока, за да се повдигне (или спусне) леглото. Ако можете да завъртите винтовете само по посока на часовниковата стрелка, изпълнете `SCREWS_TILT_CALCULATE DIRECTION=CW`. Ако можете да ги въртите само в посока, обратна на часовниковата стрелка, стартирайте `SCREWS_TILT_CALCULATE DIRECTION=CCW`. Ще бъде избрана подходяща референтна точка, така че леглото да може да бъде изравнено чрез завъртане на всички винтове в дадената посока.
