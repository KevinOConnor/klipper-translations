# Oleg Romanov <gensoloone@outlook.com>, 2023.
# gfbdrgng <hnaofegnp@hldrive.com>, 2024.
msgid ""
msgstr ""
"Report-Msgid-Bugs-To: yifeiding@protonmail.com\n"
"PO-Revision-Date: 2024-12-20 10:47+0000\n"
"Last-Translator: gfbdrgng <hnaofegnp@hldrive.com>\n"
"Language-Team: Russian <https://hosted.weblate.org/projects/klipper/canbus_troubleshooting/ru/>\n"
"Language: ru\n"
"Content-Type: text/plain; charset=UTF-8\n"
"Content-Transfer-Encoding: 8bit\n"
"Plural-Forms: nplurals=3; plural=(n%10==1 && n%100!=11 ? 0 : n%10>=2 && n%10<=4 && (n%100<10 || n%100>=20) ? 1 : 2);\n"
"X-Generator: Weblate 5.9.2-dev\n"

#: docs/CANBUS_Troubleshooting.md:block 1 (header)
msgid "CANBUS Troubleshooting"
msgstr "Устранение неполадок CANBUS"

#: docs/CANBUS_Troubleshooting.md:block 2 (paragraph)
msgid ""
"This document provides information on troubleshooting communication issues "
"when using [Klipper with CAN bus](CANBUS.md)."
msgstr ""
"Этот документ содержит информацию об исправлении проблем соединения, при "
"использовании шины CAN [Klipper with CAN bus](CANBUS.md)."

#: docs/CANBUS_Troubleshooting.md:block 3 (header)
msgid "Verify CAN bus wiring"
msgstr "Проверьте правильность подключения проводников шины CAN"

#: docs/CANBUS_Troubleshooting.md:block 4 (paragraph)
msgid ""
"The first step in troubleshooting communication issues is to verify the CAN "
"bus wiring."
msgstr ""
"Первым шагом в устранении проблем со связью является проверка проводки шины "
"CAN."

#: docs/CANBUS_Troubleshooting.md:block 5 (paragraph)
msgid ""
"Be sure there are exactly two 120 Ohm [terminating "
"resistors](CANBUS.md#terminating-resistors) on the CAN bus. If the resistors "
"are not properly installed then messages may not be able to be sent at all or "
"the connection may have sporadic instability."
msgstr ""
"Убедитесь, что на шине CAN установлено ровно два по 120 Ом [согласующих "
"резистора](CANBUS.md#terminating-resistors). Если резисторы установлены "
"неправильно, то сообщения могут не отправляться вообще или соединение может "
"быть нестабильным."

#: docs/CANBUS_Troubleshooting.md:block 6 (paragraph)
msgid ""
"The CANH and CANL bus wiring should be twisted around each other. At a "
"minimum, the wiring should have a twist every few centimeters. Avoid twisting "
"the CANH and CANL wiring around power wires and ensure that power wires that "
"travel parallel to the CANH and CANL wires do not have the same amount of "
"twists."
msgstr ""
"Провода шин CANH и CANL должны быть скручены вокруг друг друга. Как минимум, "
"проводка должна иметь скрутку через каждые несколько сантиметров. Избегайте "
"скручивания проводов CANH и CANL вокруг силовых проводов и следите за тем, "
"чтобы силовые провода, идущие параллельно проводам CANH и CANL, не имели "
"одинакового количества скруток."

#: docs/CANBUS_Troubleshooting.md:block 7 (paragraph)
msgid ""
"Verify that all plugs and wire crimps on the CAN bus wiring are fully secured."
" Movement of the printer toolhead may jostle the CAN bus wiring causing a bad "
"wire crimp or unsecured plug to result in intermittent communication errors."
msgstr ""
"Убедитесь, что все штекеры и обжимки проводов на шине CAN полностью "
"закреплены. Движение инструментальной головки принтера может привести к "
"смещению проводки шины CAN, в результате чего плохой обжим провода или "
"незакрепленный штекер могут привести к прерывистым ошибкам связи."

#: docs/CANBUS_Troubleshooting.md:block 8 (header)
msgid "Check for incrementing bytes_invalid counter"
msgstr "Проверка на увеличение счетчика bytes_invalid"

#: docs/CANBUS_Troubleshooting.md:block 9 (paragraph)
msgid ""
"The Klipper log file will report a `Stats` line once a second when the printer"
" is active. These \"Stats\" lines will have a `bytes_invalid` counter for each"
" micro-controller. This counter should not increment during normal printer "
"operation (it is normal for the counter to be non-zero after a RESTART and it "
"is not a concern if the counter increments once a month or so). If this "
"counter increments on a CAN bus micro-controller during normal printing (it "
"increments every few hours or more frequently) then it is an indication of a "
"severe problem."
msgstr ""
"Лог-файл Klipper будет сообщать о строке `Stats` раз в секунду, когда принтер "
"активен. Эти строки \"Stats\" будут содержать счетчик `bytes_invalid` для "
"каждого микроконтроллера. Этот счетчик не должен увеличиваться во время "
"нормальной работы принтера (нормально, если счетчик будет ненулевым после "
"перезагрузки, и не страшно, если счетчик будет увеличиваться раз в месяц или "
"около того). Если этот счетчик увеличивается на микроконтроллере шины CAN во "
"время нормальной печати (он увеличивается каждые несколько часов или чаще), "
"это свидетельствует о серьезной проблеме."

#: docs/CANBUS_Troubleshooting.md:block 10 (paragraph)
msgid ""
"Incrementing `bytes_invalid` on a CAN bus connection is a symptom of reordered"
" messages on the CAN bus. There are two known causes of reordered messages:"
msgstr ""
"Увеличение `bytes_invalid` при подключении к шине CAN является симптомом "
"неупорядоченных сообщений на шине CAN. Известны две причины возникновения "
"неупорядоченных сообщений:"

#: docs/CANBUS_Troubleshooting.md:block 11 (ordered list)
msgid ""
"Old versions of the popular candlight_firmware for USB CAN adapters had a bug "
"that could cause reordered messages. If using a USB CAN adapter running this "
"firmware then make sure to update to the latest firmware if incrementing "
"`bytes_invalid` is observed."
msgstr ""
"В старых версиях популярной прошивки candlight_firmware для USB CAN-адаптеров "
"была обнаружена ошибка, которая могла привести к переупорядочиванию сообщений."
" Если вы используете USB CAN адаптер с этой прошивкой, то обязательно обновите"
" ее до последней версии, если наблюдается увеличение `bytes_invalid`."

#: docs/CANBUS_Troubleshooting.md:block 11 (ordered list)
msgid ""
"Some Linux kernel builds for embedded devices have been known to reorder CAN "
"bus messages. It may be necessary to use an alternative Linux kernel or to use"
" alternative hardware that supports mainstream Linux kernels that do not "
"exhibit this problem."
msgstr ""
"Известно, что некоторые сборки ядра Linux для встраиваемых устройств "
"перестраивают сообщения шины CAN. Может потребоваться использование "
"альтернативного ядра Linux или использование альтернативного оборудования, "
"поддерживающего основные ядра Linux, в которых эта проблема не наблюдается."

#: docs/CANBUS_Troubleshooting.md:block 12 (paragraph)
msgid ""
"Reordered messages is a severe problem that must be fixed. It will result in "
"unstable behavior and can lead to confusing errors at any part of a print."
msgstr ""
"Переупорядоченные сообщения - серьезная проблема, которую необходимо "
"устранить. Она приводит к нестабильному поведению и может стать причиной "
"ошибок на любом этапе печати."

#: docs/CANBUS_Troubleshooting.md:block 13 (header)
msgid "Obtaining candump logs"
msgstr "Получение журналов candump"

#: docs/CANBUS_Troubleshooting.md:block 14 (paragraph)
msgid ""
"The CAN bus messages sent to and from the micro-controller are handled by the "
"Linux kernel. It is possible to capture these messages from the kernel for "
"debugging purposes. A log of these messages may be of use in diagnostics."
msgstr ""
"Сообщения шины CAN, отправляемые в микроконтроллер и из него, обрабатываются "
"ядром Linux. Можно перехватить эти сообщения из ядра для отладки. Журнал этих "
"сообщений может быть полезен при диагностике."

#: docs/CANBUS_Troubleshooting.md:block 15 (paragraph)
msgid ""
"The Linux [can-utils](https://github.com/linux-can/can-utils) tool provides "
"the capture software. It is typically installed on a machine by running:"
msgstr ""
"Инструмент Linux [can-utils](https://github.com/linux-can/can-utils) "
"обеспечивает программное обеспечение для захвата. Обычно она устанавливается "
"на машину путем запуска:"

#: docs/CANBUS_Troubleshooting.md:block 17 (paragraph)
msgid ""
"Once installed, one may obtain a capture of all CAN bus messages on an "
"interface with the following command:"
msgstr ""
"После установки можно получить захват всех сообщений CAN-шины на интерфейсе с "
"помощью следующей команды:"

#: docs/CANBUS_Troubleshooting.md:block 19 (paragraph)
msgid ""
"One can view the resulting log file (`mycanlog` in the example above) to see "
"each raw CAN bus message that was sent and received by Klipper. Understanding "
"the content of these messages will likely require low-level knowledge of "
"Klipper's [CANBUS protocol](CANBUS_protocol.md) and Klipper's [MCU "
"commands](MCU_Commands.md)."
msgstr ""
"Можно просмотреть полученный файл журнала (`mycanlog` в примере выше), чтобы "
"увидеть каждое необработанное сообщение CAN-шины, которое было отправлено и "
"получено Klipper. Для понимания содержания этих сообщений, скорее всего, "
"потребуются знания низкого уровня протокола [CANBUS](CANBUS_protocol.md) и "
"команд [MCU](MCU_Commands.md) Klipper."

#: docs/CANBUS_Troubleshooting.md:block 20 (header)
msgid "Parsing Klipper messages in a candump log"
msgstr "Разбор сообщений Klipper в журнале candump"

#: docs/CANBUS_Troubleshooting.md:block 21 (paragraph)
msgid ""
"One may use the `parsecandump.py` tool to parse the low-level Klipper micro-"
"controller messages contained in a candump log. Using this tool is an advanced"
" topic that requires knowledge of Klipper [MCU commands](MCU_Commands.md). For"
" example:"
msgstr ""
"Для разбора низкоуровневых сообщений микроконтроллера Klipper, содержащихся в "
"журнале candump, можно использовать инструмент `parsecandump.py`. "
"Использование этого инструмента является продвинутой темой, требующей знания "
"Klipper [команд MCU](MCU_Commands.md). Например:"

#: docs/CANBUS_Troubleshooting.md:block 23 (paragraph)
msgid ""
"This tool produces output similar to the [parsedump "
"tool](Debugging.md#translating-gcode-files-to-micro-controller-commands). See "
"the documentation for that tool for information on generating the Klipper "
"micro-controller data dictionary."
msgstr ""
"Этот инструмент выдает результаты, аналогичные [инструмент "
"parsedump](Debugging.md#translating-gcode-files-to-micro-controller-commands)."
" Информацию о генерации словаря данных микроконтроллера Klipper см. в "
"документации к этому инструменту."

#: docs/CANBUS_Troubleshooting.md:block 24 (paragraph)
msgid ""
"In the above example, `108` is the [CAN bus id](CANBUS_protocol.md#micro-"
"controller-id-assignment). It is a hexadecimal number. The id `108` is "
"assigned by Klipper to the first micro-controller. If the CAN bus has multiple"
" micro-controllers on it, then the second micro-controller would be `10a`, the"
" third would be `10c`, and so on."
msgstr ""
"В приведенном выше примере `108` - это [идентификатор шины "
"CAN](CANBUS_protocol.md#micro-controller-id-assignment). Это шестнадцатеричное"
" число. Идентификатор `108` назначается Klipper первому микроконтроллеру. Если"
" на шине CAN подключено несколько микроконтроллеров, то второй микроконтроллер"
" будет `10a`, третий - `10c` и так далее."

#: docs/CANBUS_Troubleshooting.md:block 25 (paragraph)
msgid ""
"The candump log must be produced using the `-tz -Ddex` command-line arguments "
"(for example: `candump -tz -Ddex can0,#FFFFFFFF`) in order to use the "
"`parsecandump.py` tool."
msgstr ""
"Для использования инструмента `parsecandump.py` необходимо создать журнал "
"candump, используя аргументы командной строки `-tz -Ddex` (например: `candump "
"-tz -Ddex can0,#FFFFFF`)."

#: docs/CANBUS_Troubleshooting.md:block 26 (header)
msgid "Using a logic analyzer on the canbus wiring"
msgstr "Использование логического анализатора в проводке canbus"

#: docs/CANBUS_Troubleshooting.md:block 27 (paragraph)
msgid ""
"The [Sigrok Pulseview](https://sigrok.org/wiki/PulseView) software along with "
"a low-cost [logic analyzer](https://en.wikipedia.org/wiki/Logic_analyzer) can "
"be useful for diagnosing CAN bus signaling. This is an advanced topic likely "
"only of interest to experts."
msgstr ""
"Программное обеспечение [Sigrok Pulseview](https://sigrok.org/wiki/PulseView) "
"вместе с недорогим [логическим "
"анализатором](https://en.wikipedia.org/wiki/Logic_analyzer) может быть полезно"
" для диагностики сигналов шины CAN. Это сложная тема, которая может быть "
"интересна только специалистам."

#: docs/CANBUS_Troubleshooting.md:block 28 (paragraph)
msgid ""
"One can often find \"USB logic analyzers\" for under $15 (US pricing as of "
"2023). These devices are often listed as \"Saleae logic clones\" or as \"24MHz"
" 8 channel USB logic analyzers\"."
msgstr ""
"Часто можно найти \"логические USB-анализаторы\" по цене менее 15 долларов "
"(цены в США по состоянию на 2023 год). Эти устройства часто перечисляются как "
"\"логические клоны Saleae\" или как \"24 МГц 8-канальные USB логические "
"анализаторы\"."

#: docs/CANBUS_Troubleshooting.md:block 29 (paragraph)
#, fuzzy
msgid "![pulseview-canbus](img/pulseview-canbus.png)"
msgstr "![pulseview-canbus](img/pulseview-canbus.png)"

#: docs/CANBUS_Troubleshooting.md:block 30 (paragraph)
msgid ""
"The above picture was taken while using Pulseview with a \"Saleae clone\" "
"logic analyzer. The Sigrok and Pulseview software was installed on a desktop "
"machine (also install the \"fx2lafw\" firmware if that is packaged "
"separately). The CH0 pin on the logic analyzer was routed to the CAN Rx line, "
"the CH1 pin was wired to the CAN Tx pin, and GND was wired to GND. Pulseview "
"was configured to only display the D0 and D1 lines (red \"probe\" icon center "
"top toolbar). The number of samples was set to 5 million (top toolbar) and the"
" sample rate was set to 24Mhz (top toolbar). The CAN decoder was added (yellow"
" and green \"bubble icon\" right top toolbar). The D0 channel was labeled as "
"RX and set to trigger on a falling edge (click on black D0 label at left). The"
" D1 channel was labeled as TX (click on brown D1 label at left). The CAN "
"decoder was configured for 1Mbit rate (click on green CAN label at left). The "
"CAN decoder was moved to the top of the display (click and drag green CAN "
"label). Finally, the capture was started (click \"Run\" at top left) and a "
"packet was transmitted on the CAN bus (`cansend can0 123#121212121212`)."
msgstr ""
"Приведенная выше фотография была сделана при использовании Pulseview с "
"логическим анализатором \"клон Saleae\". Программное обеспечение Sigrok и "
"Pulseview было установлено на настольном компьютере (также установите прошивку"
" \"fx2lafw\", если она поставляется отдельно). Вывод CH0 логического "
"анализатора был подключен к линии CAN Rx, вывод CH1 - к выводу CAN Tx, а GND -"
" к GND. Программа Pulseview была настроена на отображение только линий D0 и D1"
" (красный значок \"зонда\" в центре верхней панели инструментов). Количество "
"выборок было установлено на 5 миллионов (верхняя панель инструментов), а "
"частота выборки - на 24 МГц (верхняя панель инструментов). Был добавлен CAN-"
"декодер (желто-зеленый значок \"пузырька\" справа вверху панели инструментов)."
" Канал D0 был помечен как RX и настроен на срабатывание по спадающему фронту "
"импульса (нажмите на черную метку D0 слева). Канал D1 был помечен как TX "
"(нажмите на коричневую метку D1 слева). Декодер CAN был настроен на скорость 1"
" Мбит (нажмите на зеленую метку CAN слева). CAN-декодер был перемещен в "
"верхнюю часть дисплея (нажмите и перетащите зеленую метку CAN). Наконец, был "
"запущен захват (нажмите \"Run\" в левом верхнем углу) и передан пакет по шине "
"CAN (`cansend can0 123#121212121212`)."

#: docs/CANBUS_Troubleshooting.md:block 31 (paragraph)
msgid ""
"The logic analyzer provides an independent tool for capturing packets and "
"verifying bit timing."
msgstr ""
"Логический анализатор представляет собой независимый инструмент для захвата "
"пакетов и проверки временных характеристик битов."

#: docs/CANBUS_Troubleshooting.md:block 13 (header)
msgid "Use an appropriate txqueuelen setting"
msgstr "Используйте соответствующую настройку txqueuelen"

#: docs/CANBUS_Troubleshooting.md:block 14 (paragraph)
msgid ""
"The Klipper code uses the Linux kernel to manage CAN bus traffic. By default, "
"the kernel will only queue 10 CAN transmit packets. It is recommended to "
"[configure the can0 device](CANBUS.md#host-hardware) with a `txqueuelen 128` "
"to increase that size."
msgstr ""
"Код Klipper использует ядро Linux для управления трафиком шины CAN. По "
"умолчанию ядро ставит в очередь только 10 пакетов передачи данных CAN. "
"Рекомендуется [сконфигурировать устройство can0](CANBUS.md#host-hardware) с "
"`txqueuelen 128`, чтобы увеличить этот размер."

#: docs/CANBUS_Troubleshooting.md:block 15 (paragraph)
msgid ""
"If Klipper transmits a packet and Linux has filled all of its transmit queue "
"space then Linux will drop that packet and messages like the following will "
"appear in the Klipper log:"
msgstr ""
"Если Klipper передаст пакет, а Linux заполнит все место в очереди на передачу,"
" Linux отбросит этот пакет, и в журнале Klipper появятся сообщения, подобные "
"следующему:"

#: docs/CANBUS_Troubleshooting.md:block 17 (paragraph)
msgid ""
"Klipper will automatically retransmit the lost messages as part of its normal "
"application level message retransmit system. Thus, this log message is a "
"warning and it does not indicate an unrecoverable error."
msgstr ""
"Klipper автоматически повторно передаст потерянные сообщения в рамках своей "
"обычной системы повторной передачи сообщений на уровне приложения. Таким "
"образом, это сообщение журнала является предупреждением и не указывает на "
"неустранимую ошибку."

#: docs/CANBUS_Troubleshooting.md:block 18 (paragraph)
msgid ""
"If a complete CAN bus failure occurs (such as a CAN wire break) then Linux "
"will not be able to transmit any messages on the CAN bus and it is common to "
"find the above message in the Klipper log. In this case, the log message is a "
"symptom of a larger problem (the inability to transmit any messages) and is "
"not directly related to Linux `txqueuelen`."
msgstr ""
"Если произойдет полный отказ шины CAN (например, обрыв провода CAN), то Linux "
"не сможет передавать сообщения по шине CAN, и обычно в журнале Klipper "
"появляется вышеуказанное сообщение. В этом случае сообщение в журнале является"
" симптомом более серьезной проблемы (невозможность передачи сообщений) и не "
"имеет прямого отношения к Linux `txqueuelen`."

#: docs/CANBUS_Troubleshooting.md:block 19 (paragraph)
msgid ""
"One may check the current queue size by running the Linux command `ip link "
"show can0`. It should report a bunch of text including the snippet `qlen 128`."
" If one sees something like `qlen 10` then it indicates the CAN device has not"
" been properly configured."
msgstr ""
"Проверить текущий размер очереди можно, выполнив команду Linux `ip link show "
"can0`. Она должна выдать кучу текста, включая фрагмент `qlen 128`. Если вы "
"увидите что-то вроде `qlen 10`, это указывает на то, что CAN-устройство не "
"было правильно сконфигурировано."

#: docs/CANBUS_Troubleshooting.md:block 20 (paragraph)
msgid ""
"It is not recommended to use a `txqueuelen` significantly larger than 128. A "
"CAN bus running at a frequency of 1000000 will typically take around 120us to "
"transmit a CAN packet. Thus a queue of 128 packets is likely to take around "
"15-20ms to drain. A substantially larger queue could cause excessive spikes in"
" message round-trip-time which could lead to unrecoverable errors. Said "
"another way, Klipper's application retransmit system is more robust if it does"
" not have to wait for Linux to drain an excessively large queue of possibly "
"stale data. This is analogous to the problem of "
"[bufferbloat](https://en.wikipedia.org/wiki/Bufferbloat) on internet routers."
msgstr ""
"Не рекомендуется использовать `txqueuelen` значительно больше 128. CAN-шине, "
"работающей на частоте 1000000, обычно требуется около 120 с для передачи CAN-"
"пакета. Таким образом, очередь из 128 пакетов, скорее всего, займет около "
"15-20 мс. Значительно большая очередь может привести к чрезмерным скачкам "
"времени прохождения сообщений, что может привести к неустранимым ошибкам. С "
"другой стороны, система ретрансляции приложений Klipper будет более надежной, "
"если ей не придется ждать, пока Linux осушит слишком большую очередь, "
"состоящую из, возможно, устаревших данных. Это аналогично проблеме "
"[bufferbloat](https://en.wikipedia.org/wiki/Bufferbloat) на интернет-"
"маршрутизаторах."

#: docs/CANBUS_Troubleshooting.md:block 21 (paragraph)
msgid ""
"Under normal circumstances Klipper may utilize ~25 queue slots per MCU - "
"typically only utilizing more slots during retransmits. (Specifically, the "
"Klipper host may transmit up to 192 bytes to each Klipper MCU before receiving"
" an acknowledgment from that MCU.) If a single CAN bus has 5 or more Klipper "
"MCUs on it, then it might be necessary to increase the `txqueuelen` above the "
"recommended value of 128. However, as above, care should be taken when "
"selecting a new value to avoid excessive round-trip-time latency."
msgstr ""
"В обычных условиях Klipper может использовать ~25 слотов очереди на MCU - "
"обычно больше слотов используется только при повторной передаче. (В частности,"
" хост Klipper может передать до 192 байт каждому MCU Klipper, прежде чем "
"получит подтверждение от этого MCU). Если на одной шине CAN установлено 5 или "
"более MCU Klipper, то может потребоваться увеличить `txqueuelen` выше "
"рекомендуемого значения 128. Однако, как указано выше, при выборе нового "
"значения следует соблюдать осторожность, чтобы избежать чрезмерных задержек "
"при обходе."

#, fuzzy
#~ msgid "sudo apt-get update && sudo apt-get install can-utils\n"
#~ msgstr "sudo apt-get update && sudo apt-get install can-utils\n"

#, fuzzy
#~ msgid "candump -tz -Ddex can0,#FFFFFFFF > mycanlog\n"
#~ msgstr "candump -tz -Ddex can0,#FFFFFFFF > mycanlog\n"

#, fuzzy
#~ msgid "./scripts/parsecandump.py mycanlog 108 ./out/klipper.dict\n"
#~ msgstr "./scripts/parsecandump.py mycanlog 108 ./out/klipper.dict\n"

#~ msgid "Got error -1 in can write: (105)No buffer space available\n"
#~ msgstr "Получена ошибка -1 при записи: (105)Нет свободного места в буфере\n"
