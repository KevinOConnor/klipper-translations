# CANBUS

இந்த ஆவணம் கிளிப்பரின் கேன் பச் ஆதரவை விவரிக்கிறது.

## சாதன வன்பொருள்

கிளிப்பர் தற்போது STM32, Soe5x மற்றும் RP2040 சில்லுகளில் CAN ஐ ஆதரிக்கிறார். கூடுதலாக, மைக்ரோ-கன்ட்ரோலர் சிப் ஒரு கேன் டிரான்ச்சீவர் கொண்ட ஒரு போர்டில் இருக்க வேண்டும்.

CAN க்கு தொகுக்க, `மெனுகான்ஃபிக் தயாரிக்கவும், தகவல்தொடர்பு இடைமுகமாக" கேன் பச் "ஐத் தேர்ந்தெடுக்கவும். இறுதியாக, மைக்ரோ-கன்ட்ரோலர் குறியீட்டை தொகுத்து இலக்கு பலகையில் ஒளிரச் செய்யுங்கள்.

## வன்பொருள் புரவலன்

கேன் பச்சைப் பயன்படுத்த, புரவலன் அடாப்டர் வைத்திருப்பது தேவை. "யூ.எச்.பி டு கேன் அடாப்டர்" ஐப் பயன்படுத்த பரிந்துரைக்கப்படுகிறது. வெவ்வேறு உற்பத்தியாளர்களிடமிருந்து கிடைக்கக்கூடிய அடாப்டர்கள் பல வேறுபட்ட யூ.எச்.பி உள்ளன. ஒன்றைத் தேர்ந்தெடுக்கும்போது, ஃபார்ம்வேரைப் புதுப்பிக்க முடியுமா என்பதை சரிபார்க்க பரிந்துரைக்கிறோம். . ] (https://github.com/candle-usb/candlelight_fw).

அடாப்டரைப் பயன்படுத்த புரவலன் இயக்க முறைமையை உள்ளமைக்கவும் தேவை. பின்வரும் உள்ளடக்கங்களுடன் `/etc/bovent/sterverfaces.d/can0` என்ற புதிய கோப்பை உருவாக்குவதன் மூலம் இது பொதுவாக செய்யப்படுகிறது:

```
அனுமதிக்கவும்
 iface can0 நிலையானது
 பிட்ரேட் 1000000
 அப் ஐபி இணைப்பு தொகுப்பு $ iface txQuealen 128
```

## மின்தடையங்களை நிறுத்துதல்

ஒரு கேன் பச் கேன் மற்றும் கேன்ல் கம்பிகளுக்கு இடையில் இரண்டு 120 ஓம் மின்தடையங்களைக் கொண்டிருக்க வேண்டும். வெறுமனே, பச்சின் ஒவ்வொரு முடிவிலும் ஒரு மின்தடை அமைந்துள்ளது.

சில சாதனங்களில் ஒரு பில்டின் 120 ஓம் மின்தடை உள்ளது என்பதை நினைவில் கொள்க, அதை எளிதில் அகற்ற முடியாது. சில சாதனங்களில் ஒரு மின்தடை இல்லை. பிற சாதனங்கள் மின்தடையைத் தேர்ந்தெடுப்பதற்கான ஒரு வழிமுறையைக் கொண்டுள்ளன (பொதுவாக "முள் சம்பரை" இணைப்பதன் மூலம்). பச்சில் இரண்டு மற்றும் இரண்டு 120 ஓம் மின்தடையங்கள் மட்டுமே உள்ளனவா என்பதை சரிபார்க்க கேன் பச்சில் உள்ள அனைத்து சாதனங்களின் திட்டங்களையும் சரிபார்க்கவும்.

மின்தடையங்கள் சரியானவை என்பதைச் சோதிக்க, ஒருவர் அச்சுப்பொறிக்கு சக்தியை அகற்றி, பல மீட்டர்களைப் பயன்படுத்தி CAN மற்றும் CANL கம்பிகளுக்கு இடையிலான எதிர்ப்பை சரிபார்க்க முடியும் - இது சரியாக கம்பி கேன் பச்சில் ~ 60 ஓம்களைப் புகாரளிக்க வேண்டும்.

## புதிய மைக்ரோ-கன்ட்ரோலர்களுக்கான Canbus_uuid ஐக் கண்டறிதல்

CAN பச்சில் உள்ள ஒவ்வொரு மைக்ரோ-கண்ட்ரோலருக்கும் ஒவ்வொரு மைக்ரோ-கன்ட்ரோலரில் குறியிடப்பட்ட தொழிற்சாலை சிப் அடையாளங்காட்டியின் அடிப்படையில் ஒரு தனித்துவமான ஐடி ஒதுக்கப்படுகிறது. ஒவ்வொரு மைக்ரோ-கன்ட்ரோலர் சாதன ஐடியையும் கண்டுபிடிக்க, வன்பொருள் சரியாக இயங்கும் மற்றும் கம்பி சரியாக இருப்பதை உறுதிசெய்து, பின்னர் இயக்கவும்:

```
~/klippy-env/bin/python ~/klipper/scripts/canbus_query.py can0
```

Inisialialal can சாதனங்கள் கண்டறியப்பட்டால், மேலே உள்ள கட்டளை பின்வருவனவற்றைப் போன்ற வரிகளைப் புகாரளிக்கும்:

```
கிடைத்தது Canbus_uuid = 11AA22BB33CC, பயன்பாடு: கிளிப்பர்
```

ஒவ்வொரு சாதனத்திலும் ஒரு தனித்துவமான அடையாளங்காட்டி இருக்கும். மேலே உள்ள எடுத்துக்காட்டில், `11aa22bb33cc` என்பது மைக்ரோ-கன்ட்ரோலரின்" Canbus_uuid "ஆகும்.

`Canbus_query.py` கருவி ஆரம்பிக்கப்படாத சாதனங்களை மட்டுமே புகாரளிக்கும் என்பதை நினைவில் கொள்க - கிளிப்பர் (அல்லது இதே போன்ற கருவி) சாதனத்தை உள்ளமைத்தால் அது இனி பட்டியலில் தோன்றாது.

## வெட்டுக்களை உள்ளமைக்கும்

சாதனத்துடன் தொடர்பு கொள்ள CAN பச்சைப் பயன்படுத்த கிளிப்பர் [MCU உள்ளமைவு] (config_reference.md#mcu) ஐப் புதுப்பிக்கவும் - எடுத்துக்காட்டாக:

```
[MCU my_can_mcu]
 canbus_uuid: 11aa22bb33cc
```

## பச் பிரிட்ச் பயன்முறையில் யூ.எச்.பி

சில மைக்ரோ-கன்ட்ரோலர்கள் கிளிப்பரின் "மேக் மெனுகான்ஃபிக்" இன் போது "யூ.எச்.பி டு கேன் பச் பிரிட்ச்" பயன்முறையைத் தேர்ந்தெடுப்பதை ஆதரிக்கின்றனர். இந்த பயன்முறை மைக்ரோ-கன்ட்ரோலரை "யூ.எச்.பி டு கேன் பச் அடாப்டர்" மற்றும் கிளிப்பர் முனையாக பயன்படுத்த அனுமதிக்கலாம்.

கிளிப்பர் இந்த பயன்முறையைப் பயன்படுத்தும்போது, மைக்ரோ-கன்ட்ரோலர் லினக்சின் கீழ் "யூ.எச்.பி கேன் பச் அடாப்டர்" ஆகத் தோன்றும். "கிளிப்பர் பிரிட்ச் எம்.சி.யு" இது பச்சில் இருப்பது போல் தோன்றும் - இதை `Canbus_query.py` வழியாக அடையாளம் காணலாம், மேலும் இது மற்ற கேன் பச் கிளிப்பர் முனைகளைப் போல கட்டமைக்கப்பட வேண்டும்.

இந்த பயன்முறையைப் பயன்படுத்தும் போது சில முக்கியமான குறிப்புகள்:

* பச்சுடன் தொடர்புகொள்வதற்காக லினக்சில் `CAN0` (அல்லது ஒத்த) இடைமுகத்தை உள்ளமைக்க வேண்டியது தேவை. இருப்பினும், லினக்ச் பச் வேகத்தை முடியும் மற்றும் பச் பிட்-டைமிங் விருப்பங்கள் கிளிப்பரால் புறக்கணிக்கப்படுகின்றன. தற்போது, கேன் பச் அதிர்வெண் "மேக் மெனுகான்ஃபிக்" இன் போது குறிப்பிடப்பட்டுள்ளது மற்றும் லினக்சில் குறிப்பிடப்பட்டுள்ள பச் விரைவு புறக்கணிக்கப்படுகிறது.
* "பிரிட்ச் எம்.சி.யு" மீட்டமைக்கப்படும்போதெல்லாம், லினக்ச் தொடர்புடைய `CAN0` இடைமுகத்தை முடக்கும். Firmware_restart மற்றும் மறுதொடக்கம் கட்டளைகளை முறையாகக் கையாளுவதை உறுதிசெய்ய, `/etc/nect/verynce/interfaces.d/can0` கோப்பில்` அனுமதி-ஆட் பிளக்` ஐப் பயன்படுத்த பரிந்துரைக்கப்படுகிறது. உதாரணமாக:

```
அனுமதிக்கவும்
 iface can0 நிலையானது
 பிட்ரேட் 1000000
 அப் ஐபி இணைப்பு தொகுப்பு $ iface txQuealen 128
```

* "பிரிட்ச் எம்.சி.யு" உண்மையில் கேன் பச்சில் இல்லை. பாலம் MCU க்குச் செல்லும் செய்திகள் கேன் பச்சில் இருக்கக்கூடிய பிற அடாப்டர்களால் பார்க்கப்படாது.
* "பிரிட்ச் எம்.சி.யு" மற்றும் கேன் பச்சில் உள்ள அனைத்து சாதனங்களுக்கும் கிடைக்கக்கூடிய அலைவரிசை கேன் பச் அதிர்வெண்ணால் திறம்பட வரையறுக்கப்படுகிறது. இதன் விளைவாக, "யூ.எச்.பி டு கேன் பச் பிரிட்ச் பயன்முறையை" பயன்படுத்தும் போது 1000000 இன் கேன் பச் அதிர்வெண்ணைப் பயன்படுத்த பரிந்துரைக்கப்படுகிறது.

   1000000 இன் கேன் பச் அதிர்வெண்ணில் கூட, XY ச்டெப்பர்கள் மற்றும் முடுக்கமானி இரண்டும் ஒரு "யூ.எச்.பி டு கேன் பச்" இடைமுகம் வழியாக தொடர்பு கொண்டால் `சேப்பர்_லிபிரேட்` சோதனையை இயக்க போதுமான அலைவரிசை இருக்காது.
* ஒரு யூ.எச்.பி டு பிரிட்ச் போர்டு ஒரு யூ.எச்.பி சீரியல் சாதனமாக தோன்றாது, `ls/dev/serial/by-id` ஐ இயக்கும் போது அது காண்பிக்கப்படாது, மேலும் அதை` சீரியல் மூலம் klipper இன் printel.cfg கோப்பில் கட்டமைக்க முடியாது : `அளவுரு. பிரிட்ச் போர்டு "யூ.எச்.பி கேன் அடாப்டர்" ஆகத் தோன்றுகிறது, மேலும் இது அச்சுப்பொறி.

## சரிசெய்தலுக்கான உதவிக்குறிப்புகள்

[கேன் பச் சரிசெய்தல்] (canbus_troubleshooting.md) ஆவணத்தைப் பார்க்கவும்.
