# Вирівнювання столу

Вирівнювання ліжка (іноді його також називають «переміщенням ліжка») має вирішальне значення для отримання високоякісних відбитків. Якщо ложе неправильно «вирівняно», це може призвести до поганої адгезії ложа, «викривлення» та незначних проблем по всьому друку. Цей документ служить посібником для виконання вирівнювання ліжка в Klipper.

Важливо розуміти мету вирівнювання грядки. Якщо під час друку принтер отримує команду перейти в положення `X0 Y0 Z10`, тоді мета полягає в тому, щоб сопло принтера було рівно 10 мм від станини принтера. Крім того, якщо потім принтеру буде надано команду перейти в положення "X50 Z10", мета полягає в тому, щоб сопло підтримувало точну відстань 10 мм від ліжка протягом усього цього горизонтального руху.

Для отримання якісних відбитків принтер слід відкалібрувати так, щоб відстані Z були з точністю приблизно до 25 мікрон (0,025 мм). Це невелика відстань - значно менша за ширину звичайної людської волосини. Цей масштаб неможливо виміряти «на око». Незначні ефекти (наприклад, теплове розширення) впливають на вимірювання в цьому масштабі. Секрет досягнення високої точності полягає у використанні повторюваного процесу та методі вирівнювання, який використовує високу точність власної системи руху принтера.

## Виберіть відповідний механізм калібрування

Різні типи принтерів використовують різні методи для вирівнювання ложа. Усі вони зрештою залежать від «паперового тесту» (описаного нижче). Проте фактичний процес для конкретного типу принтера описано в інших документах.

Перш ніж запускати будь-який із цих інструментів калібрування, обов’язково виконайте перевірки, описані в [документі перевірки конфігурації](Config_checks.md). Необхідно перевірити основний рух принтера перед виконанням вирівнювання станини.

Для принтерів із «автоматичним зондом Z» обов’язково відкалібруйте датчик, дотримуючись вказівок у документі [Probe Calibrate](Probe_Calibrate.md). Щодо дельта-принтерів див. документ [Delta Calibrate](Delta_Calibrate.md). Інформацію про принтери з кріпильними гвинтами та традиційними торцевими упорами Z див. у документі [Manual Level](Manual_Level.md).

Під час калібрування може знадобитися встановити для Z `position_min` принтера від’ємне число (наприклад, `position_min = -2`). Принтер перевіряє межі навіть під час калібрування. Встановлення від’ємного числа дозволяє принтеру рухатися нижче номінального положення станини, що може допомогти під час спроби визначити фактичне положення станини.

## «Паперовий тест»

Основним механізмом калібрування шару є «тест на папері». Це включає в себе розміщення звичайного шматка «копіювального паперу» між станиною принтера та соплом, а потім керування соплом на різній висоті Z, доки не відчується невелике тертя під час штовхання паперу вперед і назад.

Важливо розуміти «паперовий тест», навіть якщо у вас є «автоматичний Z-зонд». Для отримання хороших результатів сам зонд часто потребує калібрування. Це калібрування зонда виконується за допомогою цього «паперового тесту».

Для виконання паперового тесту виріжте невеликий прямокутний аркуш паперу за допомогою ножиць (наприклад, 5x3 см). Папір зазвичай має товщину близько 100 мікрон (0,100 мм). (Точна товщина паперу не має вирішального значення.)

Першим кроком перевірки паперу є перевірка сопла та ложа принтера. Переконайтеся, що на насадці чи ложі немає пластику (або іншого сміття).

**Огляньте сопло та ложе, щоб переконатися, що немає пластику!**

Якщо завжди друкувати на певній стрічці чи поверхні для друку, можна виконати перевірку паперу з цією стрічкою/поверхнею на місці. Однак зауважте, що сама стрічка має товщину, і різні стрічки (або будь-яка інша поверхня для друку) впливатимуть на вимірювання Z. Обов’язково повторіть перевірку паперу, щоб виміряти кожен тип поверхні, яка використовується.

Якщо на соплі є пластик, нагрійте екструдер і використовуйте металевий пінцет, щоб видалити цей пластик. Зачекайте, поки екструдер повністю охолоне до кімнатної температури, перш ніж продовжувати перевірку паперу. Поки насадка охолоджується, використовуйте металевий пінцет, щоб видалити будь-який пластик, який може просочитися.

**Завжди виконуйте тест на папері, коли і сопло, і ложе мають кімнатну температуру!**

При нагріванні насадки її положення (відносно ложа) змінюється за рахунок теплового розширення. Це теплове розширення зазвичай становить близько 100 мікрон, що приблизно дорівнює товщині типового шматка паперу для принтера. Точна величина теплового розширення не має вирішального значення, як і точна товщина паперу не має вирішального значення. Почніть із припущення, що ці дві відстані рівні (див. нижче спосіб визначення різниці між двома відстанями).

Може здатися дивним калібрувати відстань за кімнатної температури, коли мета полягає в тому, щоб мати постійну відстань при нагріванні. Однак, якщо виконати калібрування, коли сопло нагріте, воно має тенденцію додавати невелику кількість розплавленого пластику на папір, що змінює рівень тертя. Це ускладнює отримання хорошого калібрування. Калібрування, коли ліжко/насадка гарячі, також значно підвищує ризик отримання опіків. Величина теплового розширення є стабільною, тому її легко врахувати пізніше в процесі калібрування.

**Використовуйте автоматизований інструмент, щоб визначити точну висоту Z!**

Klipper має кілька доступних допоміжних сценаріїв (наприклад, MANUAL_PROBE, Z_ENDSTOP_CALIBRATE, PROBE_CALIBRATE, DELTA_CALIBRATE). Перегляньте документи [описані вище](#choose-the-appropriate-calibration-mechanism), щоб вибрати один із них.

Виконайте відповідну команду у вікні терміналу OctoPrint. Сценарій запропонує користувачу взаємодіяти у вихідних даних терміналу OctoPrint. Це буде виглядати приблизно так:

```
Recv: // Запуск ручного Z-зонда. Використовуйте TESTZ для налаштування положення.
 Recv: // Завершити командою ACCEPT або ABORT.
 Recv: // Позиція Z: ?????? --> 5.000 <-- ??????
```

Поточна висота сопла (як її зараз розуміє принтер) відображається між «--> <--». Число праворуч означає висоту останньої спроби зондування, трохи більшу за поточну висоту, а ліворуч означає останню спробу зондування, меншу за поточну висоту (або ??????, якщо спроби не було зроблено).

Помістіть папір між соплом і ложем. Може бути корисно загнути кут паперу, щоб його було легше захопити. (Намагайтеся не натискати на ліжко, коли рухаєте папір вперед-назад.)

![папір-тест](img/папер-тест.jpg)

Використовуйте команду TESTZ, щоб попросити сопло наблизитися до паперу. Наприклад:

```
TESTZ Z=-.1
```

Команда TESTZ перемістить сопло на відносну відстань від поточного положення сопла. (Отже, `Z=-.1` вимагає, щоб насадка наблизилася до ліжка на 0,1 мм.) Після того, як насадка припинить рух, штовхніть папір вперед-назад, щоб перевірити, чи насадка торкається паперу, і відчути величина тертя. Продовжуйте видавати команди TESTZ, поки не відчуєте невелике тертя під час тестування з папером.

Якщо виявлено занадто велике тертя, можна використовувати додатне значення Z, щоб перемістити сопло вгору. Також можна використовувати `TESTZ Z=+` або `TESTZ Z=-`, щоб «розділити» останню позицію навпіл, тобто перейти до позиції посередині між двома позиціями. Наприклад, якщо хтось отримав таке підказку від команди TESTZ:

```
Recv: // Z position: 0.130 --> 0.230 <-- 0.280
```

Тоді `TESTZ Z=-` перемістить сопло в положення Z 0,180 (на півдорозі між 0,130 і 0,230). Можна використовувати цю функцію, щоб допомогти швидко звузити коло до постійного тертя. Також можна використовувати `Z=++` і `Z=--`, щоб повернутися безпосередньо до минулого вимірювання - наприклад, після наведеного вище підказки команда `TESTZ Z=--` перемістить сопло до Z положення 0,130.

Після виявлення невеликої кількості тертя виконайте команду ACCEPT:

```
ПРИЙНЯТИ
```

Це прийме задану висоту Z і продовжить роботу з заданим інструментом калібрування.

Точна величина тертя не має вирішального значення, так само як величина теплового розширення та точна ширина паперу не мають вирішального значення. Просто намагайтеся отримати однакову кількість тертя кожного разу, коли запускаєте тест.

Якщо під час тесту щось піде не так, можна скористатися командою `ABORT`, щоб вийти з інструменту калібрування.

## Визначення теплового розширення

Після успішного вирівнювання ліжка можна перейти до розрахунку більш точного значення сумарного впливу «теплового розширення», «товщини паперу» та «кількості тертя, яке відчувається під час випробування паперу».

Зазвичай цей тип обчислення не потрібен, оскільки більшість користувачів вважає, що простий «паперовий тест» дає хороші результати.

Найпростіший спосіб зробити цей розрахунок — надрукувати тестовий об’єкт, який має прямі стінки з усіх боків. Для цього можна використати великий порожнистий квадрат, знайдений у [docs/prints/square.stl](prints/square.stl). Розрізаючи об’єкт, переконайтеся, що слайсер використовує ту саму висоту шару та ширину екструзії для першого рівня, що й для всіх наступних шарів. Використовуйте грубу висоту шару (висота шару має становити близько 75% діаметра сопла) і не використовуйте краї або пліт.

Роздрукуйте тестовий об’єкт, зачекайте, поки він охолоне, і зніміть його з ложа. Огляньте нижній шар предмета. (Також може бути корисно провести пальцем або нігтем уздовж нижнього краю.) Якщо нижній шар злегка виступає вздовж усіх боків об’єкта, це означає, що сопло було трохи ближче до ложа, ніж повинно бути. Щоб збільшити висоту, можна виконати команду `SET_GCODE_OFFSET Z=+.010`. У наступних відбитках можна перевірити цю поведінку та за потреби внести додаткові коригування. Коригування цього типу, як правило, становить 10 мікрон (0,010 мм).

Якщо нижній шар постійно здається вужчим, ніж наступні шари, можна використати команду SET_GCODE_OFFSET, щоб зробити негативне коригування Z. Якщо хтось не впевнений, можна зменшити коригування Z, доки нижній шар відбитків не покаже невелику опуклість, а потім відступити, доки вона не зникне.

Найпростіший спосіб застосувати потрібне коригування Z — це створити макрос g-code START_PRINT, організувати виклик цього макросу зрізувачем на початку кожного друку та додати до цього макросу команду SET_GCODE_OFFSET. Додаткову інформацію див. у документі [slicers](Slicers.md).
