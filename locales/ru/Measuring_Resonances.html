
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.2.4, mkdocs-material-8.1.3">
    
    
      
        <title>Изменения Резонансов - Klipper documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.edf004c2.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../_klipper3d/css/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  


  <script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-VEN1PGNQL4"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&gtag("event","search",{search_term:this.value})}),"undefined"!=typeof location$&&location$.subscribe(function(e){gtag("config","G-VEN1PGNQL4",{page_path:e.pathname})})})</script>
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-VEN1PGNQL4"></script>


    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="blue">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#_1" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Klipper documentation" class="md-header__button md-logo" aria-label="Klipper documentation" data-md-component="logo">
      
  <img src="../../img/klipper.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Klipper documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Изменения Резонансов
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="blue"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9v1z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="grey" data-md-color-accent="light-blue"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5z"/></svg>
            </label>
          
        
      </form>
    
    
      <div class="md-header__option">
        <div class="md-select">
          
          <button class="md-header__button md-icon" aria-label="Select language">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.36 14c.08-.66.14-1.32.14-2 0-.68-.06-1.34-.14-2h3.38c.16.64.26 1.31.26 2s-.1 1.36-.26 2m-5.15 5.56c.6-1.11 1.06-2.31 1.38-3.56h2.95a8.03 8.03 0 0 1-4.33 3.56M14.34 14H9.66c-.1-.66-.16-1.32-.16-2 0-.68.06-1.35.16-2h4.68c.09.65.16 1.32.16 2 0 .68-.07 1.34-.16 2M12 19.96c-.83-1.2-1.5-2.53-1.91-3.96h3.82c-.41 1.43-1.08 2.76-1.91 3.96M8 8H5.08A7.923 7.923 0 0 1 9.4 4.44C8.8 5.55 8.35 6.75 8 8m-2.92 8H8c.35 1.25.8 2.45 1.4 3.56A8.008 8.008 0 0 1 5.08 16m-.82-2C4.1 13.36 4 12.69 4 12s.1-1.36.26-2h3.38c-.08.66-.14 1.32-.14 2 0 .68.06 1.34.14 2M12 4.03c.83 1.2 1.5 2.54 1.91 3.97h-3.82c.41-1.43 1.08-2.77 1.91-3.97M18.92 8h-2.95a15.65 15.65 0 0 0-1.38-3.56c1.84.63 3.37 1.9 4.33 3.56M12 2C6.47 2 2 6.5 2 12a10 10 0 0 0 10 10 10 10 0 0 0 10-10A10 10 0 0 0 12 2z"/></svg>
          </button>
          <div class="md-select__inner">
            <ul class="md-select__list">
              
                <li class="md-select__item">
                  <a href="/" hreflang="en" class="md-select__link">
                    English
                  </a>
                </li>
                
                <li class="md-select__item">
                  <a href="/zh/" hreflang="zh" class="md-select__link">
                    简体中文
                  </a>
                </li>
                
                <li class="md-select__item">
                  <a href="/zh-Hant/" hreflang="zh-Hant" class="md-select__link">
                    繁體中文
                  </a>
                </li>
                
                <li class="md-select__item">
                  <a href="/hu/" hreflang="hu" class="md-select__link">
                    Magyar
                  </a>
                </li>
                
                <li class="md-select__item">
                  <a href="/it/" hreflang="it" class="md-select__link">
                    Italiano
                  </a>
                </li>
                
                <li class="md-select__item">
                  <a href="/fr/" hreflang="fr" class="md-select__link">
                    Français
                  </a>
                </li>
                
            </ul>
          </div>
        </div>
      </div>
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/Klipper3d/klipper/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    Klipper3d/klipper
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Klipper documentation" class="md-nav__button md-logo" aria-label="Klipper documentation" data-md-component="logo">
      
  <img src="../../img/klipper.svg" alt="logo">

    </a>
    Klipper documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Klipper3d/klipper/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    Klipper3d/klipper
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../Overview.html" class="md-nav__link">
        Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../Features.html" class="md-nav__link">
        Features
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../FAQ.html" class="md-nav__link">
        Frequently Asked Questions
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../Releases.html" class="md-nav__link">
        Releases
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../Config_Changes.html" class="md-nav__link">
        Configuration Changes
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../Contact.html" class="md-nav__link">
        Contact
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          Installation and Configuration
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Installation and Configuration" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Installation and Configuration
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_1" type="checkbox" id="__nav_7_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7_1">
          Installation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Installation" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_1">
          <span class="md-nav__icon md-icon"></span>
          Installation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Installation.html" class="md-nav__link">
        Installation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../OctoPrint.html" class="md-nav__link">
        OctoPrint for Klipper
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_2" type="checkbox" id="__nav_7_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7_2">
          Configuration Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Configuration Reference" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_2">
          <span class="md-nav__icon md-icon"></span>
          Configuration Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Config_Reference.html" class="md-nav__link">
        Configuration reference
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Rotation_Distance.html" class="md-nav__link">
        Rotation distance
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Config_checks.html" class="md-nav__link">
        Configuration checks
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_4" type="checkbox" id="__nav_7_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7_4">
          Bed Level
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Bed Level" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_4">
          <span class="md-nav__icon md-icon"></span>
          Bed Level
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Bed_Level.html" class="md-nav__link">
        Bed leveling
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Delta_Calibrate.html" class="md-nav__link">
        Delta calibration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Probe_Calibrate.html" class="md-nav__link">
        Probe calibration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../BLTouch.html" class="md-nav__link">
        BL-Touch
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Manual_Level.html" class="md-nav__link">
        Manual leveling
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Bed_Mesh.html" class="md-nav__link">
        Bed Mesh
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Endstop_Phase.html" class="md-nav__link">
        Endstop phase
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Axis_Twist_Compensation.html" class="md-nav__link">
        Axis Twist Compensation
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_5" type="checkbox" id="__nav_7_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7_5">
          Resonance Compensation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Resonance Compensation" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_5">
          <span class="md-nav__icon md-icon"></span>
          Resonance Compensation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Resonance_Compensation.html" class="md-nav__link">
        Resonance Compensation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Measuring_Resonances.html" class="md-nav__link">
        Measuring Resonances
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Pressure_Advance.html" class="md-nav__link">
        Pressure advance
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../G-Codes.html" class="md-nav__link">
        G-Codes
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_8" type="checkbox" id="__nav_7_8" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7_8">
          Command templates
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Command templates" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_8">
          <span class="md-nav__icon md-icon"></span>
          Command templates
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Command_Templates.html" class="md-nav__link">
        Commands templates
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Status_Reference.html" class="md-nav__link">
        Status reference
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../TMC_Drivers.html" class="md-nav__link">
        TMC drivers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Multi_MCU_Homing.html" class="md-nav__link">
        Multiple Micro-controller Homing and Probing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Slicers.html" class="md-nav__link">
        Slicers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Skew_Correction.html" class="md-nav__link">
        Skew correction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Exclude_Object.html" class="md-nav__link">
        Exclude Objects
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Using_PWM_Tools.html" class="md-nav__link">
        Using PWM tools
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      
      
      
        <label class="md-nav__link" for="__nav_8">
          Developer Documentation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Developer Documentation" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Developer Documentation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Code_Overview.html" class="md-nav__link">
        Code overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Kinematics.html" class="md-nav__link">
        Kinematics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Protocol.html" class="md-nav__link">
        Protocol
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../API_Server.html" class="md-nav__link">
        API server
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../MCU_Commands.html" class="md-nav__link">
        MCU commands
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../CANBUS_protocol.html" class="md-nav__link">
        CANBUS protocol
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Debugging.html" class="md-nav__link">
        Debugging
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Benchmarks.html" class="md-nav__link">
        Benchmarks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../CONTRIBUTING.html" class="md-nav__link">
        Contributing to Klipper
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Packaging.html" class="md-nav__link">
        Packaging Klipper
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9" type="checkbox" id="__nav_9" >
      
      
      
      
        <label class="md-nav__link" for="__nav_9">
          Device Specific Documents
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Device Specific Documents" data-md-level="1">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          Device Specific Documents
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Example_Configs.html" class="md-nav__link">
        Example configurations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../SDCard_Updates.html" class="md-nav__link">
        SDCard updates
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../RPi_microcontroller.html" class="md-nav__link">
        RPi microcontroller
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Beaglebone.html" class="md-nav__link">
        Beaglebone
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Bootloaders.html" class="md-nav__link">
        Bootloaders
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Bootloader_Entry.html" class="md-nav__link">
        Bootloader Entry
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../CANBUS.html" class="md-nav__link">
        CANBUS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../CANBUS_Troubleshooting.html" class="md-nav__link">
        CANBUS Troubleshooting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../TSL1401CL_Filament_Width_Sensor.html" class="md-nav__link">
        TSL1401CL filament width sensor
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Hall_Filament_Width_Sensor.html" class="md-nav__link">
        Hall filament width sensor
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Eddy_Probe.html" class="md-nav__link">
        Eddy Current Inductive probe
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../Sponsors.html" class="md-nav__link">
        Sponsors
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#mcu-i2c-klipper" class="md-nav__link">
    MCU с поддержкой быстрого режима I2C от Klipper
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    Инструкции по установке
  </a>
  
    <nav class="md-nav" aria-label="Инструкции по установке">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    Электропроводка
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spi" class="md-nav__link">
    Акселерометры SPI
  </a>
  
    <nav class="md-nav" aria-label="Акселерометры SPI">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#adxl345" class="md-nav__link">
    ADXL345
  </a>
  
    <nav class="md-nav" aria-label="ADXL345">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#raspberry-pi" class="md-nav__link">
    Прямое подключение к Raspberry Pi
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#raspberry-pi-pico" class="md-nav__link">
    Использование Raspberry Pi Pico
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#i2c" class="md-nav__link">
    Акселерометры I2C
  </a>
  
    <nav class="md-nav" aria-label="Акселерометры I2C">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mpu-9250mpu-9255mpu-6515mpu-6050mpu-6500" class="md-nav__link">
    MPU-9250/MPU-9255/MPU-6515/MPU-6050/MPU-6500
  </a>
  
    <nav class="md-nav" aria-label="MPU-9250/MPU-9255/MPU-6515/MPU-6050/MPU-6500">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#i2ctwi-avr-atmega328p-arduino-nano" class="md-nav__link">
    Рекомендуемая схема подключения I2C(TWI) на AVR ATmega328P Arduino Nano:
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    Монтаж акселерометра
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    Установка программного обеспечения
  </a>
  
    <nav class="md-nav" aria-label="Установка программного обеспечения">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#adxl345-rpi" class="md-nav__link">
    Настройка ADXL345 с помощью RPi
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adxl345-pi-pico" class="md-nav__link">
    Настройка ADXL345 с Pi Pico
  </a>
  
    <nav class="md-nav" aria-label="Настройка ADXL345 с Pi Pico">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pico" class="md-nav__link">
    Прошивка микропрограммы Pico
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    Настройка соединения
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure-lis2dw-series-over-spi" class="md-nav__link">
    Configure LIS2DW series over SPI
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mpu-60009000-rpi" class="md-nav__link">
    Настройка MPU-6000/9000 серии с помощью RPi
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mpu-9520-pico" class="md-nav__link">
    Настройка совместимости MPU-9520 с Pico
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mpu-9520-avr" class="md-nav__link">
    Настройка совместимости MPU-9520 с AVR
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    Измерение резонанса
  </a>
  
    <nav class="md-nav" aria-label="Измерение резонанса">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    Проверка установки
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    Измерение резонанса
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    Печатающие устройства для постельных принадлежностей
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    Максимальное сглаживание
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#selecting-max_accel" class="md-nav__link">
    Selecting max_accel
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unreliable-measurements-of-resonance-frequencies" class="md-nav__link">
    Unreliable measurements of resonance frequencies
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    Тестирование пользовательских осей
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    Автоматическая калибровка входного формирователя
  </a>
  
    <nav class="md-nav" aria-label="Автоматическая калибровка входного формирователя">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    Повторная калибровка входного формирователя
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    Обработка данных акселерометра в автономном режиме
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
<a href="https://github.com/Klipper3d/klipper/blob/master/docs/locales/ru/Measuring_Resonances.md" title="Edit this page" class="md-content__button md-icon">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
</a>


<h1 id="_1">Изменения Резонансов<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h1>
<p>Klipper has built-in support for the ADXL345, MPU-9250, LIS2DW and LIS3DH compatible accelerometers which can be used to measure resonance frequencies of the printer for different axes, and auto-tune <a href="Resonance_Compensation.html">input shapers</a> to compensate for resonances. Note that using accelerometers requires some soldering and crimping. The ADXL345 can be connected to the SPI interface of a Raspberry Pi or MCU board (it needs to be reasonably fast). The MPU family can be connected to the I2C interface of a Raspberry Pi directly, or to an I2C interface of an MCU board that supports 400kbit/s <em>fast mode</em> in Klipper. The LIS2DW and LIS3DH can be connected to either SPI or I2C with the same considerations as above.</p>
<p>При поиске акселерометров имейте в виду, что существует множество различных конструкций печатных плат и их клонов. Если акселерометр будет подключен к MCU принтера с напряжением 5 В, убедитесь, что он оснащен стабилизатором напряжения и переключателями уровней.</p>
<p>For ADXL345s, make sure that the board supports SPI mode (a small number of boards appear to be hard-configured for I2C by pulling SDO to GND).</p>
<p>For MPU-9250/MPU-9255/MPU-6515/MPU-6050/MPU-6500s and LIS2DW/LIS3DH there are also a variety of board designs and clones with different I2C pull-up resistors which will need supplementing.</p>
<h2 id="mcu-i2c-klipper">MCU с поддержкой <em>быстрого режима</em> I2C от Klipper<a class="headerlink" href="#mcu-i2c-klipper" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th align="center">Семейство MCU</th>
<th align="left">Тестируемый микроконтроллер(ы)</th>
<th align="left">MCU с поддержкой</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">Raspberry Pi</td>
<td align="left">3B+, Pico</td>
<td align="left">3A, 3A+, 3B, 4</td>
</tr>
<tr>
<td align="center">AVR ATmega</td>
<td align="left">ATmega328p</td>
<td align="left">ATmega32u4, ATmega128, ATmega168, ATmega328, ATmega644p, ATmega1280, ATmega1284, ATmega2560</td>
</tr>
<tr>
<td align="center">AVR AT90</td>
<td align="left">-</td>
<td align="left">AT90usb646, AT90usb1286</td>
</tr>
<tr>
<td align="center">SAMD</td>
<td align="left">SAMC21G18</td>
<td align="left">SAMC21G18, SAMD21G18, SAMD21E18, SAMD21J18, SAMD21E15, SAMD51G19, SAMD51J19, SAMD51N19, SAMD51P20, SAME51J19, SAME51N19, SAME54P20</td>
</tr>
</tbody>
</table>
<h2 id="_2">Инструкции по установке<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<h3 id="_3">Электропроводка<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h3>
<p>Для обеспечения целостности сигнала на большом расстоянии рекомендуется использовать кабель ethernet с экранированными витыми парами (cat5e или лучше). Если вы по-прежнему испытываете проблемы с целостностью сигнала (ошибки SPI/I2C):</p>
<ul>
<li>Дважды проверьте проводку с помощью цифрового мультиметра:<ul>
<li>Правильные соединения в выключенном состоянии (целостность)</li>
<li>Правильное напряжение питания и заземления</li>
</ul>
</li>
<li>Только I2C:<ul>
<li>Проверьте, что сопротивление линий SCL и SDA по отношению к 3,3 В находится в диапазоне от 900 Ом до 1,8K</li>
<li>Для получения полной технической информации обратитесь к <a href="https://www.pololu.com/file/0J435/UM10204.pdf">главе 7 спецификации шины I2C и руководству пользователя UM10204</a> для <em>быстрого режима</em></li>
</ul>
</li>
<li>Укоротить кабель</li>
</ul>
<p>Подключите экран кабеля Ethernet только к заземлению платы MCU/Pi.</p>
<p><strong><em>Двойная проверка проводов перед включением питания, чтобы не повредить MCU/Raspberry Pi или акселерометр.</em></strong></p>
<h3 id="spi">Акселерометры SPI<a class="headerlink" href="#spi" title="Permanent link">&para;</a></h3>
<p>Предлагаемый порядок витой пары для трех витых пар:</p>
<div class="highlight"><pre><span></span><code>GND+MISO
3.3V+MOSI
SCLK+CS
</code></pre></div>

<p>Обратите внимание, что в отличие от экрана кабеля, GND должен быть подключен с обоих концов.</p>
<h4 id="adxl345">ADXL345<a class="headerlink" href="#adxl345" title="Permanent link">&para;</a></h4>
<h5 id="raspberry-pi">Прямое подключение к Raspberry Pi<a class="headerlink" href="#raspberry-pi" title="Permanent link">&para;</a></h5>
<p><strong>Примечание: Многие MCU будут работать с ADXL345 в режиме SPI (например, Pi Pico), подключение и конфигурация зависят от конкретной платы и доступных выводов</strong></p>
<p>Вам необходимо подключить ADXL345 к вашему Raspberry Pi через SPI. Обратите внимание, что соединение I2C, которое предлагается в документации ADXL345, имеет слишком низкую пропускную способность и <strong> не будет работать </strong>. Рекомендуемая схема подключения:</p>
<table>
<thead>
<tr>
<th align="center">ADXL345 pin</th>
<th align="center">Контакт RPi</th>
<th align="center">Название выводов RPi</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">3V3 (или VCC)</td>
<td align="center">01</td>
<td align="center">Питание 3,3 В постоянного тока</td>
</tr>
<tr>
<td align="center">GND</td>
<td align="center">06</td>
<td align="center">Земля</td>
</tr>
<tr>
<td align="center">CS</td>
<td align="center">24</td>
<td align="center">GPIO08 (SPI0_CE0_N)</td>
</tr>
<tr>
<td align="center">SDO</td>
<td align="center">21</td>
<td align="center">GPIO09 (SPI0_MISO)</td>
</tr>
<tr>
<td align="center">SDA</td>
<td align="center">19</td>
<td align="center">GPIO10 (SPI0_MOSI)</td>
</tr>
<tr>
<td align="center">SCL</td>
<td align="center">23</td>
<td align="center">GPIO11 (SPI0_SCLK)</td>
</tr>
</tbody>
</table>
<p>Схемы подключения некоторых плат ADXL345:</p>
<p><img alt="ADXL345-Rpi" src="img/adxl345-fritzing.png" /></p>
<h5 id="raspberry-pi-pico">Использование Raspberry Pi Pico<a class="headerlink" href="#raspberry-pi-pico" title="Permanent link">&para;</a></h5>
<p>Вы можете подключить ADXL345 к Raspberry Pi Pico, а затем подключить Pico к Raspberry Pi через USB. Это упрощает повторное использование акселерометра в других устройствах Klipper, так как вы можете подключить его через USB, а не через GPIO. Pico не обладает большой вычислительной мощностью, поэтому убедитесь, что он работает только с акселерометром и не выполняет никаких других функций.</p>
<p>Во избежание повреждения RPi убедитесь, что ADXL345 подключен только к 3,3 В. В зависимости от разводки платы может присутствовать переключатель уровней, что сделает 5 В опасным для вашей RPi.</p>
<table>
<thead>
<tr>
<th align="center">ADXL345 pin</th>
<th align="center">Pico pin</th>
<th align="center">Название вывода Pico</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">3V3 (или VCC)</td>
<td align="center">36</td>
<td align="center">Питание 3,3 В постоянного тока</td>
</tr>
<tr>
<td align="center">GND</td>
<td align="center">38</td>
<td align="center">Земля</td>
</tr>
<tr>
<td align="center">CS</td>
<td align="center">2</td>
<td align="center">GP1 (SPI0_CSn)</td>
</tr>
<tr>
<td align="center">SDO</td>
<td align="center">1</td>
<td align="center">GP0 (SPI0_RX)</td>
</tr>
<tr>
<td align="center">SDA</td>
<td align="center">5</td>
<td align="center">GP3 (SPI0_TX)</td>
</tr>
<tr>
<td align="center">SCL</td>
<td align="center">4</td>
<td align="center">GP2 (SPI0_SCK)</td>
</tr>
</tbody>
</table>
<p>Схемы подключения некоторых плат ADXL345:</p>
<p><img alt="ADXL345-Pico" src="img/adxl345-pico.png" /></p>
<h3 id="i2c">Акселерометры I2C<a class="headerlink" href="#i2c" title="Permanent link">&para;</a></h3>
<p>Предлагаемый порядок витой пары - три пары (предпочтительно):</p>
<div class="highlight"><pre><span></span><code>3.3V+GND
SDA+GND
SCL+GND
</code></pre></div>

<p>или для двух пар:</p>
<div class="highlight"><pre><span></span><code>3.3V+SDA
GND+SCL
</code></pre></div>

<p>Обратите внимание, что в отличие от экрана кабеля, любые GND(ы) должны быть подключены с обоих концов.</p>
<h4 id="mpu-9250mpu-9255mpu-6515mpu-6050mpu-6500">MPU-9250/MPU-9255/MPU-6515/MPU-6050/MPU-6500<a class="headerlink" href="#mpu-9250mpu-9255mpu-6515mpu-6050mpu-6500" title="Permanent link">&para;</a></h4>
<p>Эти акселерометры протестированы на работу по протоколу I2C на RPi, RP2040 (Pico) и AVR со скоростью 400 кбит/с (<em>быстрый режим</em>). Некоторые модули акселерометров MPU включают подтягивающие резисторы, но некоторые из них слишком велики - 10K, и их необходимо заменить или дополнить меньшими параллельными резисторами.</p>
<p>Рекомендуемая схема подключения I2C на Raspberry Pi:</p>
<table>
<thead>
<tr>
<th align="center">MPU-9250 pin</th>
<th align="center">Контакт RPi</th>
<th align="center">Название выводов RPi</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">VCC</td>
<td align="center">01</td>
<td align="center">Питание 3,3 В постоянного тока</td>
</tr>
<tr>
<td align="center">GND</td>
<td align="center">09</td>
<td align="center">Земля</td>
</tr>
<tr>
<td align="center">SDA</td>
<td align="center">03</td>
<td align="center">GPIO02 (SDA1)</td>
</tr>
<tr>
<td align="center">SCL</td>
<td align="center">05</td>
<td align="center">GPIO03 (SCL1)</td>
</tr>
</tbody>
</table>
<p>RPi имеет встроенные подтяжки 1,8K на SCL и SDA.</p>
<p><img alt="MPU-9250 подключен к Pi" src="img/mpu9250-PI-fritzing.png" /></p>
<p>Рекомендуемая схема подключения I2C (i2c0a) на RP2040:</p>
<table>
<thead>
<tr>
<th align="center">MPU-9250 pin</th>
<th align="center">RP2040 pin</th>
<th align="center">Название выводов RP2040</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">VCC</td>
<td align="center">36</td>
<td align="center">3v3</td>
</tr>
<tr>
<td align="center">GND</td>
<td align="center">38</td>
<td align="center">Земля</td>
</tr>
<tr>
<td align="center">SDA</td>
<td align="center">01</td>
<td align="center">GP0 (I2C0 SDA)</td>
</tr>
<tr>
<td align="center">SCL</td>
<td align="center">02</td>
<td align="center">GP1 (I2C0 SCL)</td>
</tr>
</tbody>
</table>
<p>В Pico нет встроенных подтягивающих резисторов I2C.</p>
<p><img alt="MPU-9250 подключен к Pico" src="img/mpu9250-PICO-fritzing.png" /></p>
<h5 id="i2ctwi-avr-atmega328p-arduino-nano">Рекомендуемая схема подключения I2C(TWI) на AVR ATmega328P Arduino Nano:<a class="headerlink" href="#i2ctwi-avr-atmega328p-arduino-nano" title="Permanent link">&para;</a></h5>
<table>
<thead>
<tr>
<th align="center">MPU-9250 pin</th>
<th align="center">Atmega328P TQFP32 pin</th>
<th align="center">Название выводов Atmega328P</th>
<th align="center">Arduino Nano pin</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">VCC</td>
<td align="center">39</td>
<td align="center">-</td>
<td align="center">-</td>
</tr>
<tr>
<td align="center">GND</td>
<td align="center">38</td>
<td align="center">Земля</td>
<td align="center">GND</td>
</tr>
<tr>
<td align="center">SDA</td>
<td align="center">27</td>
<td align="center">SDA</td>
<td align="center">A4</td>
</tr>
<tr>
<td align="center">SCL</td>
<td align="center">28</td>
<td align="center">SCL</td>
<td align="center">A5</td>
</tr>
</tbody>
</table>
<p>В Arduino Nano нет ни встроенных подтягивающих резисторов, ни вывода питания 3,3 В.</p>
<h3 id="_4">Монтаж акселерометра<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h3>
<p>Акселерометр должен быть прикреплен к инструментальной головке. Необходимо разработать соответствующее крепление, которое подойдет для вашего 3D-принтера. Оси акселерометра лучше совместить с осями принтера (но если так будет удобнее, оси можно поменять местами - то есть не нужно совмещать ось X с X и так далее - все будет хорошо, даже если ось Z акселерометра будет совпадать с осью X принтера и т. д.).</p>
<p>Пример установки ADXL345 на SmartEffector:</p>
<p><img alt="ADXL345 on SmartEffector" src="img/adxl345-mount.jpg" /></p>
<p>Обратите внимание, что для принтера со станиной необходимо разработать два крепления: одно для инструментальной головки и одно для станины, и выполнить измерения дважды. Более подробную информацию смотрите в соответствующем <a href="#bed-slinger-printers">разделе</a>.</p>
<p><strong>Внимание:</strong> убедитесь, что акселерометр и винты, удерживающие его на месте, не касаются металлических частей принтера. В принципе, крепление должно быть спроектировано таким образом, чтобы обеспечить электрическую изоляцию акселерометра от рамы принтера. Если этого не сделать, в системе может возникнуть контур заземления, который может повредить электронику.</p>
<h3 id="_5">Установка программного обеспечения<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h3>
<p>Обратите внимание, что для измерения резонанса и автоматической калибровки шейпера требуются дополнительные программные зависимости, не установленные по умолчанию. Сначала выполните на вашем Raspberry Pi следующие команды:</p>
<div class="highlight"><pre><span></span><code>sudo apt update
sudo apt install python3-numpy python3-matplotlib libatlas-base-dev libopenblas-dev
</code></pre></div>

<p>Далее, чтобы установить NumPy в среду Klipper, выполните команду:</p>
<div class="highlight"><pre><span></span><code>~/klippy-env/bin/pip install -v &quot;numpy&lt;1.26&quot;
</code></pre></div>

<p>Note that, depending on the performance of the CPU, it may take <em>a lot</em> of time, up to 10-20 minutes. Be patient and wait for the completion of the installation. On some occasions, if the board has too little RAM the installation may fail and you will need to enable swap. Also note the forced version, due to newer versions of NumPY having requirements that may not be satisfied in some klipper python environments.</p>
<p>Once installed please check that no errors show from the command:</p>
<div class="highlight"><pre><span></span><code>~/klippy-env/bin/python -c &#39;import numpy;&#39;
</code></pre></div>

<p>The correct output should simply be a new line.</p>
<h4 id="adxl345-rpi">Настройка ADXL345 с помощью RPi<a class="headerlink" href="#adxl345-rpi" title="Permanent link">&para;</a></h4>
<p>Сначала проверьте и следуйте инструкциям в документе <a href="RPi_microcontroller.html">RPi Microcontroller</a>, чтобы настроить "linux mcu" на Raspberry Pi. Это позволит настроить второй экземпляр Klipper, который будет работать на вашем Pi.</p>
<p>Убедитесь, что драйвер Linux SPI включен, запустив <code>sudo raspi-config</code> и включив SPI в меню "Параметры взаимодействия".</p>
<p>Добавьте следующее в файл printer.cfg:</p>
<div class="highlight"><pre><span></span><code>[mcu rpi]
serial: /tmp/klipper_host_mcu

[adxl345]
cs_pin: rpi: Нет

[resonance_tester]
accel_chip: adxl345
probe_points:
    100, 100, 20 # пример
</code></pre></div>

<p>Рекомендуется начать с 1 точки зондирования, расположенной в середине печатного слоя и немного выше него.</p>
<h4 id="adxl345-pi-pico">Настройка ADXL345 с Pi Pico<a class="headerlink" href="#adxl345-pi-pico" title="Permanent link">&para;</a></h4>
<h5 id="pico">Прошивка микропрограммы Pico<a class="headerlink" href="#pico" title="Permanent link">&para;</a></h5>
<p>На вашем Raspberry Pi скомпилируйте прошивку для Pico.</p>
<div class="highlight"><pre><span></span><code>cd ~/klipper
make clean
make menuconfig
</code></pre></div>

<p><img alt="Pico menuconfig" src="img/klipper_pico_menuconfig.png" /></p>
<p>Теперь, удерживая кнопку <code>BOOTSEL</code> на Pico, подключите Pico к Raspberry Pi через USB. Скомпилируйте и прошейте прошивку.</p>
<div class="highlight"><pre><span></span><code>make flash FLASH_DEVICE=first
</code></pre></div>

<p>Если это не удастся, вам будет указано, какой <code>FLASH_DEVICE</code> следует использовать. В данном примере это <code>make flash FLASH_DEVICE=2e8a:0003</code>. <img alt="Определить флеш-устройство" src="img/flash_rp2040_FLASH_DEVICE.png" /></p>
<h5 id="_6">Настройка соединения<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h5>
<p>Теперь Pico перезагрузится с новой прошивкой и будет отображаться как последовательное устройство. Найдите последовательное устройство pico с помощью <code>ls /dev/serial/by-id/*</code>. Теперь вы можете добавить файл <code>adxl.cfg</code> со следующими настройками:</p>
<div class="highlight"><pre><span></span><code>[mcu adxl]
# Измените &lt;mySerial&gt; на то, что вы нашли выше. Например,
# usb-Klipper_rp2040_E661640843545B2E-if00
serial: /dev/serial/by-id/usb-Klipper_rp2040_&lt;mySerial&gt;

[adxl345]
cs_pin: adxl:gpio1
spi_bus: spi0a
axes_map: x,z,y

[resonance_tester]
accel_chip: adxl345
probe_points:
    # Где-то чуть выше середины печатной формы
    147,154, 20

[output_pin power_mode] # Улучшение стабильности питания
вывод: adxl:gpio23
</code></pre></div>

<p>Если конфигурация ADXL345 задается в отдельном файле, как показано выше, вам также потребуется изменить файл <code>printer.cfg</code>, чтобы включить его:</p>
<div class="highlight"><pre><span></span><code>[include adxl.cfg] # Закомментируйте это при отключении акселерометра
</code></pre></div>

<p>Перезапустите Klipper с помощью команды <code>RESTART</code>.</p>
<h4 id="configure-lis2dw-series-over-spi">Configure LIS2DW series over SPI<a class="headerlink" href="#configure-lis2dw-series-over-spi" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>[mcu lis]
# Измените &lt;mySerial&gt; на то, что вы нашли выше. Например,
# usb-Klipper_rp2040_E661640843545B2E-if00
serial: /dev/serial/by-id/usb-Klipper_rp2040_&lt;mySerial&gt;

[lis2dw]
cs_pin: lis:gpio1
шина spi_bus: spi0a
axes_map: x,z,y

[resonance_tester]
accel_chip: lis2dw
probe_points:
    # Где-то чуть выше середины печатной формы
    147,154, 20
</code></pre></div>

<h4 id="mpu-60009000-rpi">Настройка MPU-6000/9000 серии с помощью RPi<a class="headerlink" href="#mpu-60009000-rpi" title="Permanent link">&para;</a></h4>
<p>Убедитесь, что драйвер Linux I2C включен, а скорость передачи данных установлена на 400000 (подробнее см. в разделе <a href="RPi_microcontroller.html#optional-enabling-i2c">Enabling I2C</a>). Затем добавьте следующее в файл printer.cfg:</p>
<div class="highlight"><pre><span></span><code>[mcu rpi]
serial: /tmp/klipper_host_mcu

[mpu9250]
i2c_mcu: rpi
i2c_bus: i2c.1

[resonance_tester]
accel_chip: mpu9250
probe_points:
    100, 100, 20 # пример
</code></pre></div>

<h4 id="mpu-9520-pico">Настройка совместимости MPU-9520 с Pico<a class="headerlink" href="#mpu-9520-pico" title="Permanent link">&para;</a></h4>
<p>По умолчанию для Pico I2C установлено значение 400000. Просто добавьте следующее в файл printer.cfg:</p>
<div class="highlight"><pre><span></span><code>[mcu pico]
serial: /dev/serial/by-id/&lt;серийный идентификатор вашего Pico&gt;

[mpu9250]
i2c_mcu: pico
i2c_bus: i2c0a

[resonance_tester]
accel_chip: mpu9250
probe_points:
    100, 100, 20 # пример

[static_digital_output pico_3V3pwm] # Улучшение стабильности питания
выводы: pico:gpio23
</code></pre></div>

<h4 id="mpu-9520-avr">Настройка совместимости MPU-9520 с AVR<a class="headerlink" href="#mpu-9520-avr" title="Permanent link">&para;</a></h4>
<p>Для AVR I2C будет установлено значение 400000 с помощью опции mpu9250. Просто добавьте следующее в файл printer.cfg:</p>
<div class="highlight"><pre><span></span><code>[mcu nano]
serial: /dev/serial/by-id/&lt;серийный идентификатор вашего nano&gt;

[mpu9250]
i2c_mcu: nano

[resonance_tester]
accel_chip: mpu9250
probe_points:
    100, 100, 20   # пример
</code></pre></div>

<p>Перезапустите Klipper с помощью команды <code>RESTART</code>.</p>
<h2 id="_7">Измерение резонанса<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h2>
<h3 id="_8">Проверка установки<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h3>
<p>Теперь вы можете проверить соединение.</p>
<ul>
<li>Для "не-акселерометров" (например, с одним акселерометром), в Octoprint введите <code>ACCELEROMETER_QUERY</code></li>
<li>Для "кроватных слингов" (например, более одного акселерометра) введите <code>ACCELEROMETER_QUERY CHIP=&lt;chip&gt;</code>, где <code>&lt;chip&gt;</code> - имя введенного чипа, например, <code>CHIP=bed</code> ( смотрите: <a href="#bed-slinger-printers">bed-slinger</a>) для всех установленных чипов акселерометров.</li>
</ul>
<p>Вы должны увидеть текущие измерения акселерометра, включая ускорение свободного падения, например.</p>
<div class="highlight"><pre><span></span><code>Recv: // значения adxl345 (x, y, z): 470.719200, 941.438400, 9728.196800
</code></pre></div>

<p>Если вы получите ошибку типа <code>Invalid adxl345 id (got xx vs e5)</code>, где <code>xx</code> - это какой-то другой ID, немедленно повторите попытку. Это проблема с инициализацией SPI. Если вы по-прежнему получаете ошибку, это говорит о проблеме с подключением ADXL345 или неисправном датчике. Дважды проверьте питание, проводку (соответствует ли она схеме, нет ли оборванных или ослабленных проводов и т.д.) и качество пайки.</p>
<p><strong>Если вы используете акселерометр, совместимый с MPU-9250, и он отображается как <code>mpu-unknown</code>, используйте его с осторожностью! Скорее всего, это восстановленные микросхемы!</strong></p>
<p>Далее попробуйте запустить <code>MEASURE_AXES_NOISE</code> в Octoprint, вы должны получить некоторые базовые цифры для шума акселерометра по осям (должны быть где-то в диапазоне ~1-100). Слишком высокий шум по осям (например, 1000 и более) может свидетельствовать о проблемах с датчиком, проблемах с его питанием или слишком шумных несбалансированных вентиляторах на 3D-принтере.</p>
<h3 id="_9">Измерение резонанса<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h3>
<p>Теперь вы можете провести несколько реальных тестов. Выполните следующую команду:</p>
<div class="highlight"><pre><span></span><code>TEST_RESONANCES AXIS=X
</code></pre></div>

<p>Обратите внимание, что это создаст вибрации по оси X. Это также отключит формирование входного сигнала, если оно было включено ранее, так как проведение резонансного тестирования с включенным формирователем входного сигнала недопустимо.</p>
<p><strong>Внимание! </strong> Обязательно понаблюдайте за принтером в первый раз, чтобы убедиться, что вибрации не станут слишком сильными (команда <code>M112</code> может быть использована для прерывания теста в случае крайней необходимости; надеемся, что до этого не дойдет). Если вибрации все же становятся слишком сильными, можно попытаться задать меньшее, чем по умолчанию, значение параметра <code>accel_per_hz</code> в разделе <code>[resonance_tester]</code>, например.</p>
<div class="highlight"><pre><span></span><code>[resonance_tester]
accel_chip: adxl345
accel_per_hz: 50  # default is 75
probe_points: ...
</code></pre></div>

<p>Если это работает для оси X, запустите и для оси Y:</p>
<div class="highlight"><pre><span></span><code>TEST_RESONANCES AXIS=Y
</code></pre></div>

<p>В результате будут сгенерированы 2 файла CSV (<code>/tmp/resonances_x_*.csv</code> и <code>/tmp/resonances_y_*.csv</code>). Эти файлы можно обработать с помощью автономного скрипта на Raspberry Pi. Этот скрипт предназначен для запуска с одним CSV-файлом для каждой измеряемой оси, хотя его можно использовать с несколькими CSV-файлами, если вы хотите усреднить результаты. Усреднение результатов может быть полезным, например, если резонансные испытания проводились в нескольких точках. Удалите дополнительные CSV-файлы, если вы не хотите усреднять их.</p>
<div class="highlight"><pre><span></span><code>~/klipper/scripts/calibrate_shaper.py /tmp/resonances_x_*.csv -o /tmp/shaper_calibrate_x.png
~/klipper/scripts/calibrate_shaper.py /tmp/resonances_y_*.csv -o /tmp/shaper_calibrate_y.png
</code></pre></div>

<p>Этот скрипт сгенерирует графики <code>/tmp/shaper_calibrate_x.png</code> и <code>/tmp/shaper_calibrate_y.png</code> с частотными характеристиками. Вы также получите предлагаемые частоты для каждого входного формирователя, а также то, какой входной формирователь рекомендуется для вашей установки. Например:</p>
<p><img alt="Resonances" src="img/calibrate-y.png" /></p>
<div class="highlight"><pre><span></span><code>Частота шейпера &#39;zv&#39; = 34,4 Гц (вибрации = 4,0%, сглаживание ~= 0,132)
Чтобы избежать слишком сильного сглаживания при использовании &#39;zv&#39;, предлагается max_accel &lt;= 4500 мм/сек^2
Частота шейпера &#39;mzv&#39; = 34,6 Гц (вибрации = 0,0%, сглаживание ~= 0,170)
Чтобы избежать слишком сильного сглаживания при использовании &#39;mzv&#39;, предлагается max_accel &lt;= 3500 мм/сек^2
Подогнанная частота шейпера &#39;ei&#39; = 41,4 Гц (колебания = 0,0%, сглаживание ~= 0,188)
Чтобы избежать слишком сильного сглаживания при использовании &#39;ei&#39;, предлагается max_accel &lt;= 3200 мм/сек^2
Частота шейпера &#39;2hump_ei&#39; = 51,8 Гц (вибрации = 0,0%, сглаживание ~= 0,201)
Чтобы избежать слишком сильного сглаживания при использовании &#39;2hump_ei&#39;, предлагается max_accel &lt;= 3000 мм/сек^2
Частота шейпера &#39;3hump_ei&#39; = 61,8 Гц (колебания = 0,0%, сглаживание ~= 0,215)
Чтобы избежать слишком сильного сглаживания с &#39;3hump_ei&#39;, предлагается max_accel &lt;= 2800 мм/сек^2
Рекомендуемый шейпер - mzv @ 34.6 Гц
</code></pre></div>

<p>Предлагаемую конфигурацию можно добавить в раздел <code>[input_shaper]</code> файла <code>printer.cfg</code>, например:</p>
<div class="highlight"><pre><span></span><code>[input_shaper]
shaper_freq_x: ...
shaper_type_x: ...
shaper_freq_y: 34.6
shaper_type_y: mzv

[принтер]
max_accel: 3000 # не должно превышать расчетное значение max_accel для осей X и Y
</code></pre></div>

<p>или вы можете самостоятельно выбрать другую конфигурацию, основываясь на сгенерированных графиках: пики спектральной плотности мощности на графиках соответствуют резонансным частотам принтера.</p>
<p>Обратите внимание, что в качестве альтернативы вы можете запустить автокалибровку входного формирователя из Klipper <a href="#input-shaper-auto-calibration">напрямую</a>, что может быть удобно, например, для повторной калибровки входного формирователя <a href="#input-shaper-re-calibration">re-calibration</a>.</p>
<h3 id="_10">Печатающие устройства для постельных принадлежностей<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h3>
<p>Если ваш принтер является принтером со станиной, вам нужно будет изменить расположение акселерометра между измерениями по осям X и Y: измерять резонансы по оси X с акселерометром, прикрепленным к инструментальной головке, а резонансы по оси Y - к станине (обычная установка станины).</p>
<p>Однако можно подключить и два акселерометра одновременно, правда, ADXL345 должны быть подключены к разным платам (например, к плате RPi и плате MCU принтера) или к двум разным физическим SPI-интерфейсам на одной плате (что бывает редко). Затем их можно сконфигурировать следующим образом:</p>
<div class="highlight"><pre><span></span><code>[adxl345 hotend]
# Предполагается, что микросхема `hotend` подключена к RPi
cs_pin: rpi:None

[adxl345 bed]
# Предполагается, что микросхема `bed` подключена к плате MCU принтера
cs_pin: ...  # Вывод выбора микросхемы SPI платы принтера (CS)

[resonance_tester]
# Предполагается, что типичная установка принтера-раскладушки
accel_chip_x: adxl345 hotend
accel_chip_y: adxl345 bed
probe_points: ...
</code></pre></div>

<p>Два MPU могут использовать одну шину I2C, но они <strong>не могут</strong> проводить измерения одновременно, поскольку скорость шины I2C 400 кбит/с недостаточна. Один из них должен иметь вывод AD0, подтянутый к 0 В (адрес 104), а другой - вывод AD0, подтянутый к 3,3 В (адрес 105):</p>
<div class="highlight"><pre><span></span><code>[mpu9250 hotend]
i2c_mcu: rpi
i2c_bus: i2c.1
i2c_address: 104 # У этого MPU пин AD0 подтянут к низкому уровню.

[mpu9250 bed]
i2c_mcu: rpi
i2c_bus: i2c.1
i2c_address: 105 # У этого MPU пин AD0 подтянут к высокому уровню.

[resonance_tester]
# Предполагаем типичную настройку принтера с продольными полозьями
accel_chip_x: mpu9250 hotend
accel_chip_y: mpu9250 bed
probe_points: ...
</code></pre></div>

<p>[Протестируйте каждый MPU по отдельности, прежде чем подключать оба к шине, чтобы облегчить отладку]</p>
<p>Тогда команды <code>TEST_RESONANCES AXIS=X</code> и <code>TEST_RESONANCES AXIS=Y</code> будут использовать правильный акселерометр для каждой оси.</p>
<h3 id="_11">Максимальное сглаживание<a class="headerlink" href="#_11" title="Permanent link">&para;</a></h3>
<p>Помните, что входной формирователь может создавать некоторое сглаживание в отдельных частях. Автоматическая настройка входного формирователя, выполняемая скриптом <code>calibrate_shaper.py</code> или командой <code>SHAPER_CALIBRATE</code>, старается не усугублять сглаживание, но в то же время пытается минимизировать возникающие вибрации. Иногда они могут сделать неоптимальный выбор частоты шейпера, или, возможно, вы просто предпочитаете меньшее сглаживание в частях за счет больших остаточных вибраций. В таких случаях можно попросить ограничить максимальное сглаживание от входного формирователя.</p>
<p>Рассмотрим следующие результаты автоматической настройки:</p>
<p><img alt="Resonances" src="img/calibrate-x.png" /></p>
<div class="highlight"><pre><span></span><code>Частота шейпера &#39;zv&#39; = 57,8 Гц (вибрации = 20,3%, сглаживание ~= 0,053)
Чтобы избежать слишком сильного сглаживания при использовании &#39;zv&#39;, предлагается max_accel &lt;= 13000 мм/сек^2
Частота шейпера &#39;mzv&#39; = 34,8 Гц (вибрации = 3,6%, сглаживание ~= 0,168)
Чтобы избежать слишком сильного сглаживания при использовании &#39;mzv&#39;, предлагается max_accel &lt;= 3600 мм/сек^2
Частота шейпера &#39;ei&#39; = 48,8 Гц (вибрации = 4,9%, сглаживание ~= 0,135)
Чтобы избежать слишком сильного сглаживания при использовании &#39;ei&#39;, предлагается max_accel &lt;= 4400 мм/сек^2
Частота шейпера &#39;2hump_ei&#39; = 45,2 Гц (вибрации = 0,1%, сглаживание ~= 0,264)
Чтобы избежать слишком сильного сглаживания при использовании &#39;2hump_ei&#39;, предлагается max_accel &lt;= 2200 мм/сек^2
Частота шейпера &#39;3hump_ei&#39; = 48,0 Гц (вибрации = 0,0%, сглаживание ~= 0,356)
Чтобы избежать слишком сильного сглаживания при использовании &#39;3hump_ei&#39;, предлагается max_accel &lt;= 1500 мм/сек^2
Рекомендуемый шейпер - 2hump_ei @ 45,2 Гц
</code></pre></div>

<p>Обратите внимание, что указанные значения <code>сглаживания</code> - это некие абстрактные прогнозируемые значения. Эти значения можно использовать для сравнения различных конфигураций: чем выше значение, тем больше сглаживания создаст шейпер. Однако эти показатели сглаживания не являются реальной мерой сглаживания, поскольку фактическое сглаживание зависит от параметров <a href="#selecting-max-accel"><code>max_accel</code></a> и <code>square_corner_velocity</code>. Поэтому вам следует напечатать несколько тестовых отпечатков, чтобы узнать, сколько сглаживания создает выбранная конфигурация.</p>
<p>В приведенном примере предложенные параметры шейпера неплохи, но что, если вы хотите получить меньшее сглаживание по оси X? Вы можете попробовать ограничить максимальное сглаживание шейпера с помощью следующей команды:</p>
<div class="highlight"><pre><span></span><code>~/klipper/scripts/calibrate_shaper.py /tmp/resonances_x_*.csv -o /tmp/shaper_calibrate_x.png --max_smoothing=0.2
</code></pre></div>

<p>что ограничивает сглаживание до 0,2 балла. Теперь вы можете получить следующий результат:</p>
<p><img alt="Resonances" src="img/calibrate-x-max-smoothing.png" /></p>
<div class="highlight"><pre><span></span><code>Частота шейпера &#39;zv&#39; = 55,4 Гц (вибрации = 19,7%, сглаживание ~= 0,057)
Чтобы избежать слишком сильного сглаживания при использовании &#39;zv&#39;, предлагается max_accel &lt;= 12000 мм/сек^2
Частота шейпера &#39;mzv&#39; = 34,6 Гц (вибрации = 3,6%, сглаживание ~= 0,170)
Чтобы избежать слишком сильного сглаживания при использовании &#39;mzv&#39;, предлагается max_accel &lt;= 3500 мм/сек^2
Подогнанная частота шейпера &#39;ei&#39; = 48,2 Гц (колебания = 4,8%, сглаживание ~= 0,139)
Чтобы избежать слишком сильного сглаживания при использовании &#39;ei&#39;, предлагается max_accel &lt;= 4300 мм/сек^2
Частота шейпера &#39;2hump_ei&#39; = 52,0 Гц (вибрации = 2,7%, сглаживание ~= 0,200)
Чтобы избежать слишком сильного сглаживания при использовании &#39;2hump_ei&#39;, предлагается max_accel &lt;= 3000 мм/сек^2
Частота шейпера &#39;3hump_ei&#39; = 72,6 Гц (колебания = 1,4%, сглаживание ~= 0,155)
Чтобы избежать слишком сильного сглаживания с помощью &#39;3hump_ei&#39;, предлагается max_accel &lt;= 3900 мм/сек^2
Рекомендуемый шейпер - 3hump_ei @ 72,6 Гц
</code></pre></div>

<p>Если сравнивать с ранее предложенными параметрами, то вибрации немного больше, но сглаживание значительно меньше, чем раньше, что позволяет увеличить максимальное ускорение.</p>
<p>При выборе параметра <code>max_smoothing</code> вы можете использовать метод проб и ошибок. Попробуйте несколько различных значений и посмотрите, какие результаты вы получите. Обратите внимание, что фактическое сглаживание, производимое входным формирователем, зависит, прежде всего, от самой низкой резонансной частоты принтера: чем выше частота самого низкого резонанса - тем меньше сглаживание. Поэтому, если вы попросите скрипт найти конфигурацию входного формирователя с нереально малым сглаживанием, это произойдет за счет увеличения звона на самых низких резонансных частотах (которые, как правило, также более заметны на отпечатках). Поэтому всегда перепроверяйте прогнозируемые остаточные колебания, сообщаемые скриптом, и убедитесь, что они не слишком высоки.</p>
<p>Обратите внимание, что если вы выбрали хорошее значение <code>max_smoothing</code> для обеих осей, вы можете сохранить его в файле <code>printer.cfg</code> как</p>
<div class="highlight"><pre><span></span><code>[resonance_tester]
accel_chip: ...
probe_points: ...
max_smoothing: 0.25 # пример
</code></pre></div>

<p>Тогда, если в будущем вы <a href="#input-shaper-re-calibration">повторно</a> запустите автонастройку входного шейпера с помощью команды <code>SHAPER_CALIBRATE</code> Klipper, он будет использовать сохраненное значение <code>max_smoothing</code> в качестве эталона.</p>
<h3 id="selecting-max_accel">Selecting max_accel<a class="headerlink" href="#selecting-max_accel" title="Permanent link">&para;</a></h3>
<p>Поскольку входной формирователь может создавать некоторое сглаживание деталей, особенно при высоких ускорениях, вам все равно придется выбрать значение <code>max_accel</code>, которое не будет создавать слишком сильного сглаживания на отпечатанных деталях. Сценарий калибровки предоставляет оценку параметра <code>max_accel</code>, который не должен создавать слишком сильного сглаживания. Обратите внимание, что значение <code>max_accel</code>, отображаемое калибровочным скриптом, является лишь теоретическим максимумом, при котором соответствующий формирователь еще способен работать, не создавая слишком сильного сглаживания. Ни в коем случае не рекомендуется устанавливать это ускорение для печати. Максимальное ускорение, которое способен выдержать ваш принтер, зависит от его механических свойств и максимального крутящего момента используемых шаговых двигателей. Поэтому рекомендуется установить <code>max_accel</code> в секции <code>[принтер]</code>, не превышающее расчетных значений для осей X и Y, скорее всего, с некоторым консервативным запасом прочности.</p>
<p>В качестве альтернативы, следуйте <a href="Resonance_Compensation.html#selecting-max_accel">this</a> части руководства по настройке входного формирователя и распечатайте тестовую модель для экспериментального выбора параметра <code>max_accel</code>.</p>
<p>Это же замечание относится и к входному шейперу <a href="#input-shaper-auto-calibration">автокалибровка</a> с командой <code>SHAPER_CALIBRATE</code>: после автокалибровки по-прежнему необходимо выбрать правильное значение <code>max_accel</code>, и предложенные ограничения ускорения не будут применяться автоматически.</p>
<p>Помните, что максимальное ускорение без слишком сильного сглаживания зависит от значения <code>square_corner_velocity</code>. Общая рекомендация - не изменять его от значения по умолчанию 5.0, и именно это значение используется по умолчанию скриптом <code>calibrate_shaper.py</code>. Если вы все же изменили его, то сообщите об этом скрипту, передав параметр <code>--square_corner_velocity=...</code>, например.</p>
<div class="highlight"><pre><span></span><code>~/klipper/scripts/calibrate_shaper.py /tmp/resonances_x_*.csv -o /tmp/shaper_calibrate_x.png --square_corner_velocity=10.0
</code></pre></div>

<p>чтобы правильно рассчитать рекомендации по максимальному ускорению. Обратите внимание, что команда <code>SHAPER_CALIBRATE</code> уже учитывает настроенный параметр <code>square_corner_velocity</code>, и нет необходимости указывать его явно.</p>
<p>Если вы выполняете повторную калибровку формирователя и полученное значение сглаживания для предложенной конфигурации формирователя почти такое же, как и при предыдущей калибровке, этот шаг можно пропустить.</p>
<h3 id="unreliable-measurements-of-resonance-frequencies">Unreliable measurements of resonance frequencies<a class="headerlink" href="#unreliable-measurements-of-resonance-frequencies" title="Permanent link">&para;</a></h3>
<p>Sometimes the resonance measurements can produce bogus results, leading to the incorrect suggestions for the input shapers. This can be caused by a variety of reasons, including running fans on the toolhead, incorrect position or non-rigid mounting of the accelerometer, or mechanical problems such as loose belts or binding or bumpy axis. Keep in mind that all fans should be disabled for resonance testing, especially the noisy ones, and that the accelerometer should be rigidly mounted on the corresponding moving part (e.g. on the bed itself for the bed slinger, or on the extruder of the printer itself and not the carriage, and some people get better results by mounting the accelerometer on the nozzle itself). As for mechanical problems, the user should inspect if there is any fault that can be fixed with a moving axis (e.g. linear guide rails cleaned up and lubricated and V-slot wheels tension adjusted correctly). If none of that helps, a user may try the other shapers from the produced list besides the one recommended by default.</p>
<h3 id="_12">Тестирование пользовательских осей<a class="headerlink" href="#_12" title="Permanent link">&para;</a></h3>
<p>Команда <code>TEST_RESONANCES</code> поддерживает пользовательские оси. Хотя это не очень полезно для калибровки входного формирователя, ее можно использовать для углубленного изучения резонансов принтера и, например, для проверки натяжения ремня.</p>
<p>Чтобы проверить натяжение ремня на принтерах CoreXY, выполните команду</p>
<div class="highlight"><pre><span></span><code>TEST_RESONANCES AXIS=1,1 OUTPUT=raw_data
TEST_RESONANCES AXIS=1,-1 OUTPUT=raw_data
</code></pre></div>

<p>и используйте <code>graph_accelerometer.py</code> для обработки сгенерированных файлов, например</p>
<div class="highlight"><pre><span></span><code>~/klipper/scripts/graph_accelerometer.py -c /tmp/raw_data_axis*.csv -o /tmp/resonances.png
</code></pre></div>

<p>который создаст файл <code>/tmp/resonances.png</code>, сравнивающий резонансы.</p>
<p>Для принтеров Delta с размещением башни по умолчанию (башня A ~= 210 градусов, B ~= 330 градусов и C ~= 90 градусов) выполните команду</p>
<div class="highlight"><pre><span></span><code>TEST_RESONANCES AXIS=0,1 OUTPUT=raw_data
TEST_RESONANCES AXIS=-0.866025404,-0.5 OUTPUT=raw_data
TEST_RESONANCES AXIS=0.866025404,-0.5 OUTPUT=raw_data
</code></pre></div>

<p>а затем выполните ту же команду</p>
<div class="highlight"><pre><span></span><code>~/klipper/scripts/graph_accelerometer.py -c /tmp/raw_data_axis*.csv -o /tmp/resonances.png
</code></pre></div>

<p>чтобы создать файл <code>/tmp/resonances.png</code>, сравнивающий резонансы.</p>
<h2 id="_13">Автоматическая калибровка входного формирователя<a class="headerlink" href="#_13" title="Permanent link">&para;</a></h2>
<p>Помимо ручного выбора подходящих параметров для функции входного формирователя, можно также запустить автонастройку входного формирователя непосредственно из Klipper. Выполните следующую команду через терминал Octoprint:</p>
<div class="highlight"><pre><span></span><code>SHAPER_CALIBRATE
</code></pre></div>

<p>Это запустит полный тест для обеих осей и сгенерирует выходной файл csv (по умолчанию <code>/tmp/calibration_data_*.csv</code>) для частотной характеристики и предлагаемых входных формирователей. Вы также получите предлагаемые частоты для каждого входного формирователя, а также информацию о том, какой входной формирователь рекомендуется для вашей установки, на консоли Octoprint. Например:</p>
<div class="highlight"><pre><span></span><code>Расчет оптимальных параметров входного формирователя для оси y
Подходящая частота шейвера &#39;zv&#39; = 39,0 Гц (вибрации = 13,2%, сглаживание ~= 0,105)
Чтобы избежать слишком сильного сглаживания при использовании &#39;zv&#39;, предлагается max_accel &lt;= 5900 мм/сек^2
Частота шейпера &#39;mzv&#39; = 36,8 Гц (вибрации = 1,7%, сглаживание ~= 0,150)
Чтобы избежать слишком сильного сглаживания при использовании &#39;mzv&#39;, предлагается max_accel &lt;= 4000 мм/сек^2
Частота шейпера &#39;ei&#39; = 36,6 Гц (вибрации = 2,2%, сглаживание ~= 0,240)
Чтобы избежать слишком сильного сглаживания при использовании &#39;ei&#39;, предлагается max_accel &lt;= 2500 мм/сек^2
Частота шейпера &#39;2hump_ei&#39; = 48,0 Гц (вибрации = 0,0%, сглаживание ~= 0,234)
Чтобы избежать слишком сильного сглаживания при использовании &#39;2hump_ei&#39;, предлагается max_accel &lt;= 2500 мм/сек^2
Частота шейпера &#39;3hump_ei&#39; = 59,0 Гц (вибрации = 0,0%, сглаживание ~= 0,235)
Чтобы избежать слишком сильного сглаживания при использовании &#39;3hump_ei&#39;, предлагается max_accel &lt;= 2500 мм/сек^2
Рекомендуемый тип шейпера_y = mzv, частота шейпера_y = 36,8 Гц
</code></pre></div>

<p>Если вы согласны с предложенными параметрами, вы можете выполнить команду <code>SAVE_CONFIG</code>, чтобы сохранить их и перезапустить Klipper. Обратите внимание, что это не приведет к обновлению значения <code>max_accel</code> в разделе <code>[принтер]</code>. Вы должны обновить его вручную, следуя указаниям в разделе <a href="#selecting-max_accel">Выбор max_accel</a>.</p>
<p>Если ваш принтер является принтером со станиной, вы можете указать, какую ось тестировать, чтобы между тестами можно было менять точку установки акселерометра (по умолчанию тест выполняется для обеих осей):</p>
<div class="highlight"><pre><span></span><code>SHAPER_CALIBRATE AXIS=Y
</code></pre></div>

<p>Вы можете выполнить <code>SAVE_CONFIG</code> дважды - после калибровки каждой оси.</p>
<p>Однако если вы подключили два акселерометра одновременно, достаточно запустить <code>SHAPER_CALIBRATE</code> без указания оси, чтобы откалибровать входной формирователь для обеих осей за один раз.</p>
<h3 id="_14">Повторная калибровка входного формирователя<a class="headerlink" href="#_14" title="Permanent link">&para;</a></h3>
<p>Команда <code>SHAPER_CALIBRATE</code> может также использоваться для повторной калибровки входного формирователя в будущем, особенно если в принтер были внесены некоторые изменения, которые могут повлиять на его кинематику. Можно либо повторно выполнить полную калибровку с помощью команды <code>SHAPER_CALIBRATE</code>, либо ограничить автокалибровку одной осью, указав параметр <code>AXIS=</code>, например</p>
<div class="highlight"><pre><span></span><code>SHAPER_CALIBRATE AXIS=X
</code></pre></div>

<p><strong>Предупреждение!</strong> Не рекомендуется выполнять автокалибровку шейпера очень часто (например, перед каждой печатью или каждый день). Для определения резонансных частот автокалибровка создает интенсивные вибрации по каждой из осей. Как правило, 3D-принтеры не рассчитаны на длительное воздействие вибраций, близких к резонансным частотам. Это может увеличить износ компонентов принтера и сократить срок их службы. Также повышается риск откручивания или ослабления некоторых деталей. Всегда проверяйте, чтобы все детали принтера (включая те, которые обычно не двигаются) были надежно закреплены на месте после каждой автонастройки.</p>
<p>Кроме того, из-за некоторого шума при измерениях возможно, что результаты настройки будут немного отличаться от одного прогона калибровки к другому. Тем не менее, не ожидается, что шум сильно повлияет на качество печати. Тем не менее, рекомендуется перепроверить предложенные параметры и напечатать несколько пробных отпечатков перед использованием, чтобы убедиться в их правильности.</p>
<h2 id="_15">Обработка данных акселерометра в автономном режиме<a class="headerlink" href="#_15" title="Permanent link">&para;</a></h2>
<p>Можно сгенерировать необработанные данные акселерометра и обработать их в автономном режиме (например, на хост-машине), например, для поиска резонансов. Для этого выполните следующие команды через терминал Octoprint:</p>
<div class="highlight"><pre><span></span><code>SET_INPUT_SHAPER SHAPER_FREQ_X=0 SHAPER_FREQ_Y=0
TEST_RESONANCES AXIS=X OUTPUT=raw_data
</code></pre></div>

<p>игнорируя любые ошибки для команды <code>SET_INPUT_SHAPER</code>. Для команды <code>TEST_RESONANCES</code> укажите желаемую тестовую ось. Необработанные данные будут записаны в каталог <code>/tmp</code> на RPi.</p>
<p>Необработанные данные можно также получить, выполнив команду <code>ACCELEROMETER_MEASURE</code> дважды во время обычной работы принтера - сначала для запуска измерений, а затем для их остановки и записи выходного файла. Более подробную информацию см. в <a href="G-Codes.html#adxl345">G-Codes</a>.</p>
<p>Полученные данные могут быть обработаны следующими скриптами: <code>scripts/graph_accelerometer.py</code> и <code>scripts/calibrate_shaper.py</code>. Оба они принимают на вход один или несколько необработанных csv-файлов в зависимости от режима. Скрипт graph_accelerometer.py поддерживает несколько режимов работы:</p>
<ul>
<li>При построении графика необработанных данных акселерометра (используйте параметр <code>-r</code>), поддерживается только 1 вход;</li>
<li>построение частотной характеристики (дополнительные параметры не требуются), если задано несколько входов, вычисляется средняя частотная характеристика;</li>
<li>сравнение частотных характеристик между несколькими входами (используется параметр <code>-c</code>); вы можете дополнительно указать, какую ось акселерометра учитывать через параметр <code>-a x</code>, <code>-a y</code> или <code>-a z</code> (если он не указан, используется сумма колебаний по всем осям);</li>
<li>При построении спектрограммы (используется параметр <code>-s</code>) поддерживается только 1 вход; дополнительно можно указать, какую ось акселерометра учитывать через параметр <code>-a x</code>, <code>-a y</code> или <code>-a z</code> (если он не указан, используется сумма колебаний по всем осям).</li>
</ul>
<p>Обратите внимание, что скрипт graph_accelerometer.py поддерживает только файлы raw_data*.csv, но не файлы resonances*.csv или calibration_data*.csv.</p>
<p>Например,</p>
<div class="highlight"><pre><span></span><code>~/klipper/scripts/graph_accelerometer.py /tmp/raw_data_x_*.csv -o /tmp/resonances_x.png -c -a z
</code></pre></div>

<p>построит график сравнения нескольких файлов <code>/tmp/raw_data_x_*.csv</code> для оси Z с файлом <code>/tmp/resonances_x.png</code>.</p>
<p>Скрипт shaper_calibrate.py принимает 1 или несколько входных данных и может выполнить автоматическую настройку входного формирователя и предложить наилучшие параметры, которые хорошо работают для всех предоставленных входных данных. Он выводит предложенные параметры на консоль, а также может дополнительно сгенерировать график, если указан параметр <code>-o output.png</code>, или CSV-файл, если указан параметр <code>-c output.csv</code>.</p>
<p>Предоставление нескольких входов скрипту shaper_calibrate.py может быть полезно, например, при выполнении расширенной настройки входных шейперов:</p>
<ul>
<li>Запуск <code>TEST_RESONANCES AXIS=X OUTPUT=raw_data</code> (и оси <code>Y</code>) для одной оси дважды на принтере со станиной с акселерометром, прикрепленным к головке инструмента в первый раз, и акселерометром, прикрепленным к станине во второй раз, чтобы обнаружить кросс-резонансы осей и попытаться устранить их с помощью входных формирователей.</li>
<li>Запустите <code>TEST_RESONANCES AXIS=Y OUTPUT=raw_data</code> дважды на стропальщике со стеклянной и магнитной поверхностями (которая легче), чтобы найти входные параметры формирователя, которые хорошо работают для любой конфигурации поверхности печати.</li>
<li>Объединение резонансных данных из нескольких точек тестирования.</li>
<li>Комбинирование данных резонанса по двум осям (например, в принтере с продольным механизмом печати для настройки X-axis input_shaper на основе резонансов по осям X и Y для устранения вибраций <em>кровати</em> в случае, если сопло "ловит" печать при движении в направлении оси X).</li>
</ul>

              
            </article>
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" data-md-state="hidden">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.top", "search.suggest", "search.highlight", "search.share"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.0bbba5b5.min.js"}</script>
    
    
      <script src="../../assets/javascripts/bundle.e1a181d9.min.js"></script>
      
    
  </body>
</html>